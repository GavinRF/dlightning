window.updateComponentSwatches=function(e){makeSwatchesResponsive(e)},window.TextContrastAdjuster=class{static init(){this.updateTextColors();const e=document.getElementById("darkModeToggle");e&&e.addEventListener("change",this.debouncedUpdate.bind(this)),document.addEventListener("color:change",this.debouncedUpdate.bind(this))}static updateElementContrast(e){if(!e)return;const t=window.getComputedStyle(e).backgroundColor;if(!t||"transparent"===t||"rgba(0, 0, 0, 0)"===t)return;const n=t.match(/\d+/g);if(!n)return;const a=(.299*n[0]+.587*n[1]+.114*n[2])/255>.5?"#000000":"#FFFFFF";e.style.color=a}static debouncedUpdate(){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((()=>{this.updateTextColors()}),100)}static updateTextColors(){document.querySelectorAll('.canvas-content [style*="background-color"]').forEach((e=>this.updateElementContrast(e)))}};class MobileUIEditor{modalAdded=!1;fabAdded=!1;constructor(){this.state={canvasCount:0,selectedCanvases:new Set,navbarStates:new Map,sidebarAdded:!1},this.topNavbarAdded=!1,this.bottomNavbarAdded=!1,this.setupCanvasReordering(),this.textAlignmentController=new TextAlignmentController(".canvas-content"),this.animationController=new AnimationController,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>this.init())):this.init(),this.specialComponents={navbar:{added:!1,content:null},bottomNav:{added:!1,content:null},sidebar:{added:!1,content:null},modal:{added:!1,content:null},floatingActionButton:{added:!1,content:null}},document.addEventListener("mouseover",(e=>{if(e.target.matches(".delete-btn")){const t=e.target.closest(".component-container");t&&(t.style.outline=".08rem solid var(--error-danger-delete)",t.style.transition="outline 0.2s ease")}if(e.target.matches(".duplicate-btn, .duplicate-btn .fa-clone")){const t=e.target.closest(".component-container");t&&(t.style.outline=".08rem solid var(--primary-color)",t.style.transition="outline 0.2s ease")}if(e.target.matches(".component-handle")){const t=e.target.closest(".component-container");t&&(t.style.outline=".08rem solid rgba(128, 128, 128, 0.68)",t.style.transition="outline 0.2s ease")}})),document.addEventListener("mouseout",(e=>{if(e.target.matches(".delete-btn, .duplicate-btn, .duplicate-btn .fa-clone, .component-handle")){const t=e.target.closest(".component-container");t&&(t.style.outline="")}}))}init(){this.initializeFirstCanvas(),this.setupEventListeners(),this.initPreviewSystem(),this.setupDownloadButton(),this.updateTime(),setInterval(this.updateTime,6e4),this.initOnboarding(),window.TextContrastAdjuster.init()}initializeFirstCanvas(){this.createNewCanvas();const e=document.querySelector(".canvas");e.classList="canvas selected",e&&(this.state.selectedCanvases.add(e),e.addEventListener("click",(e=>this.handleCanvasSelection(e))))}updateTime(){const e=new Date,t=e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0");document.querySelectorAll(".time").forEach((e=>{e.textContent=t}))}setupCanvasReordering(){const e=document.querySelector("#mockZone");e&&new Sortable(e,{animation:150,handle:".canvas-number-container",draggable:".canvas-wrapper",ghostClass:"canvas-ghost",chosenClass:"canvas-chosen",dragClass:"canvas-drag",forceFallback:!1,onStart:e=>{document.body.classList.add("canvas-dragging");const t=e.item,n=t.getBoundingClientRect();t.dataset.startX=n.left,t.dataset.startY=n.top,t.dataset.originalIndex=e.oldIndex},onEnd:e=>{document.body.classList.remove("canvas-dragging"),this.updateCanvasNumbers();const t=e.item;parseInt(t.dataset.originalIndex)!==e.newIndex&&(t.classList.add("canvas-drop-success"),setTimeout((()=>{t.classList.remove("canvas-drop-success")}),300),projectManager&&"function"==typeof projectManager.markAllCanvasesChanged&&projectManager.markAllCanvasesChanged("Canvas reordering"))}})}initializeSortable(e){return e._sortable&&e._sortable.destroy(),new Sortable(e,{multiDrag:!0,selectedClass:"selected-drag",fallbackTolerance:3,animation:150,handle:".component-handle",ghostClass:"sortable-ghost",group:"shared-components",fallbackClass:"sortable-fallback",fallbackOnBody:!1,revertOnSpill:!1,swapThreshold:.85,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,setData:function(e,t){t.style.cssText=window.getComputedStyle(t).cssText},onStart:function(e){const t=e.item;t.classList.add("pulse-drag");const n=t.closest(".canvas-wrapper");if(n&&(t.setAttribute("data-source-canvas-id",n.getAttribute("data-canvas-id")),projectManager&&void 0!==projectManager.contentChanged)){projectManager.contentChanged=!0;const e=n.getAttribute("data-canvas-id");projectManager.getChangedCanvases&&e&&setTimeout((()=>{console.log(`%cMarking source canvas ${e} as changed due to component removal`,"color: #FF9800; font-weight: bold"),"function"==typeof projectManager.addCanvasToChanged&&projectManager.addCanvasToChanged(e,"Component removal")}),0)}document.querySelectorAll(".column-container").forEach((e=>{e.style.outline=".12rem dashed var(--interface-color)",e.style.outlineOffset="-1px"})),document.querySelectorAll(".blankSpace").forEach((e=>{e.style.backgroundColor="rgba(52, 152, 219, 0.2)";const t=e.querySelector(".empty-placeholder");t&&(t.style.visibility="visible")}));const a=()=>{t.classList.remove("pulse-drag"),t.removeEventListener("animationend",a)};t.addEventListener("animationend",a),e.item.querySelector(".space-range:active")&&e.preventDefault()},onEnd:function(e){document.querySelectorAll(".column-container").forEach((e=>{e.style.outline="none",e.style.outlineOffset="0"})),document.querySelectorAll(".blankSpace").forEach((e=>{e.style.backgroundColor="rgba(52, 152, 219, 0)";const t=e.querySelector(".empty-placeholder");t&&(t.style.visibility="hidden")})),$(e.item).trigger("mouseleave");const t=e.item,n=t.querySelector(".card-image");n&&n.classList.contains("with-image")&&(n.style.backgroundColor="transparent"),e.from===e.to&&e.oldIndex===e.newIndex||(t.classList.add("success-drop"),setTimeout((()=>{t.classList.remove("success-drop")}),300));[...e.from.querySelectorAll(".card-image"),...e.to.querySelectorAll(".card-image")].forEach((e=>{e.classList.contains("with-image")&&(e.style.backgroundColor="transparent")}));const a=e=>{e.querySelectorAll(".color-swatch-container").forEach((e=>{e.style.visibility="hidden",e.style.opacity="0"}));const t=e.querySelector(".add-image-button"),n=e.querySelector(".size-control"),a=e.querySelector(".left-arrow"),o=e.querySelector(".right-arrow"),r=e.querySelector(".resize-handle"),s=e.querySelector(".alignment-controls"),l=e.querySelector(".columns-controls"),c=e.querySelectorAll(".alignment-arrow");[r,t,n,a,o,s,l].forEach((e=>{e&&(e.style.display="none")})),c&&c.forEach((e=>{e.style.visibility="hidden"}))};a(e.from),a(e.to);const o=e.to.closest(".canvas-wrapper");if(o){const e=t.getAttribute("data-source-canvas-id"),n=o.getAttribute("data-canvas-id");e&&n&&e!==n&&(console.log(`%cComponent moved from canvas ${e} to ${n}`,"color: #4CAF50; font-weight: bold"),projectManager&&(projectManager.contentChanged=!0,t.removeAttribute("data-source-canvas-id")))}},onAdd:function(e){e.item.style.width="100%",window.TextContrastAdjuster&&setTimeout((()=>{window.TextContrastAdjuster.updateElementContrast(e.item),e.item.querySelectorAll('[style*="background-color"]').forEach((e=>{window.TextContrastAdjuster.updateElementContrast(e)}))}),0)},onMove:function(e){document.querySelectorAll(".column-container").forEach((e=>{e.style.outline=".12rem dashed var(--interface-color)",e.style.outlineOffset="-1px"}));const t=e.to.closest(".column-container");return t&&(t.style.outline=".12rem dashed var(--color-primary)",t.style.outlineOffset="-2px"),!e.related.classList.contains("navbar-spacer")}})}setupEventListeners(){document.querySelectorAll(".component-btn, .addHeadingButton").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),this.handleComponentAddition(e)}))}));const e=document.querySelector(".add-canvas-btn");e&&e.addEventListener("click",(e=>{e.preventDefault(),this.createNewCanvas()})),document.addEventListener("click",(e=>{e.target.classList.contains("delete-canvas-btn")&&this.handleCanvasDelete(e)}))}initPreviewSystem(){document.querySelectorAll(".preview-trigger").forEach((e=>{e.addEventListener("click",(e=>{this.handlePreviewTrigger(e)}))}))}handlePreviewTrigger(e){const t=e.currentTarget,n=t.closest(".comp-btn-wrap"),a=n.querySelector(".component-btn"),o=a.getAttribute("data-component"),r=n.querySelector(".preview-container"),s=t.querySelector(".toggle-icon");if(s.style.transition="transform 0.3s ease",r)return void("0px"!==r.style.maxHeight?(r.style.maxHeight="0",s.style.transform="rotate(0deg)",setTimeout((()=>{r.style.display="none"}),300)):(s.style.transform="rotate(180deg)",r.style.display="block",requestAnimationFrame((()=>{r.style.maxHeight=r.querySelector("div").scrollHeight+32+"px"}))));s.style.transform="rotate(180deg)";const l=document.createElement("div");l.className="preview-container",l.style.cssText="\n        border-radius: 4px;\n        overflow: hidden;\n        max-height: 0;\n        transition: max-height 0.3s ease-out;\n        flex-grow: 12;\n        margin-bottom: 2px;\n    ";const c=document.createElement("div");if(c.style.padding="22px 10px 12px 10px",c.style.maxWidth="100%",c.style.overflow="hidden",this.components[o]){let e=this.components[o](),t=this.wrapComponentInContainer(e,o);t.classList.add("preview-component"),a.previewComponent=t,c.appendChild(t),l.appendChild(c),n.appendChild(l),requestAnimationFrame((()=>{t.querySelectorAll('[style*="background-color"]').forEach((e=>{window.TextContrastAdjuster.updateElementContrast(e)}))})),new Sortable(c,{group:{name:"shared-components",put:!1,pull:"clone"},sort:!1,handle:".component-handle",animation:150,onStart:e=>{const t=e.item;t.setAttribute("data-preview-state","true");t.querySelectorAll(".color-swatch-container").forEach((e=>{e.style.visibility="hidden"})),document.querySelectorAll(".column-container").forEach((e=>{e.style.outline=".12rem dashed var(--interface-color)",e.style.outlineOffset="-1px"})),document.querySelectorAll(".blankSpace").forEach((e=>{e.style.backgroundColor="rgba(52, 152, 219, 0.2)";const t=e.querySelector(".empty-placeholder");t&&(t.style.visibility="visible")}))},onEnd:e=>{document.querySelectorAll(".column-container").forEach((e=>{e.style.outline="none",e.style.outlineOffset="0"})),document.querySelectorAll(".blankSpace").forEach((e=>{e.style.backgroundColor="rgba(52, 152, 219, 0)";const t=e.querySelector(".empty-placeholder");t&&(t.style.visibility="hidden")})),$(e.item).trigger("mouseleave");const t=e.item.querySelector(".card-image");t&&t.classList.contains("with-image")&&(t.style.backgroundColor="transparent");const n=e.item;if(e.clone&&e.clone.remove(),e.to.classList.contains("canvas-content")||e.to.classList.contains("colorBlock-inner")||e.to.classList.contains("accordion-content")||e.to.classList.contains("blank-card-content")||e.to.classList.contains("column-container")){this.duplicateComponent(n,o)&&(e.to.appendChild(n),"true"===n.getAttribute("data-preview-state")&&n.removeAttribute("data-preview-state"))}if("true"===n.getAttribute("data-preview-state")){n.removeAttribute("data-preview-state"),c.appendChild(n);n.querySelectorAll(".resize-handle").forEach((e=>e.style.display="none"));n.querySelectorAll(".alignment-arrow").forEach((e=>e.style.display="none"));n.querySelectorAll(".alignment-controls").forEach((e=>e.style.display="none"));n.querySelectorAll(".columns-controls").forEach((e=>e.style.display="none"))}},onMove:function(e){document.querySelectorAll(".column-container").forEach((e=>{e.style.outline=".12rem dashed var(--interface-color)",e.style.outlineOffset="-1px"}));const t=e.to.closest(".column-container");return t&&(t.style.outline=".12rem dashed var(--color-primary)",t.style.outlineOffset="-2px"),!e.related.classList.contains("navbar-spacer")}}),requestAnimationFrame((()=>{l.style.maxHeight=c.scrollHeight+32+"px"}))}}async handleComponentAddition(e){const t=e.getAttribute("data-component"),n=Array.from(document.querySelectorAll(".canvas-content")).reduce(((e,t)=>e+t.querySelectorAll(".component-container").length),0),a=firebase.auth().currentUser;if(a){if(!await imageManager.checkProAccess(a.uid)&&n>=28)return void projectManager.showSubscriptionModal("Upgrade to Add More Components","Free accounts are limited to 28 components per project.")}const o=Array.from(this.state.selectedCanvases);if(this.isSpecialComponent(t)){if(Array.from(o).some((e=>(e.setAttribute(`data-has-${t}`,"true"),this.hasSpecialComponent(e,t)))))return this.removeSpecialComponent(t,o),void o.forEach((e=>e.removeAttribute(`data-has-${t}`)))}let r;if(e.previewComponent){const t=e.previewComponent.querySelector(".component-content");t&&t.dataset.currentVariant&&(r=parseInt(t.dataset.currentVariant))}0!==this.state.selectedCanvases.size?o.forEach((n=>{if(!n)return void console.error("No canvas found");let a,o,r;switch(t){case"navbar":a=this.components.navbar(),this.topNavbarAdded=!0,this.insertNavbar(n,a,"top");break;case"bottomNav":a=this.components.bottomNav(),this.bottomNavbarAdded=!0,this.insertNavbar(n,a,"bottom");break;case"sidebar":a=this.components.sidebar(),this.insertNavbar(n,a,"left");break;case"modal":if(this.modalAdded){const e=n.querySelector(".modal-wrapper");e&&e.remove()}else a=this.components.modal(),n.appendChild(a);break;case"floatingActionButton":this.fabAdded||(a=this.components.floatingActionButton(),n.appendChild(a));break;case"hero":if(a=this.components.hero(),o=this.wrapComponentInContainer(a,"hero"),r=n.querySelector(".canvas-content"),r){const e=r.firstChild;n.querySelector(".navbar-spacer")&&e?r.insertBefore(o,e.nextSibling):e?r.insertBefore(o,e):r.appendChild(o)}break;case"heading":const s=e.getAttribute("data-level");if(a=this.components.heading(null,s||"h1","Heading Text"),o=this.wrapComponentInContainer(a,"heading"),r=n.querySelector(".canvas-content"),r){const e=r.querySelector("footer")?.closest(".component-container");e?r.insertBefore(o,e):r.appendChild(o)}break;default:if(a=this.components[t]?.(),o=this.wrapComponentInContainer(a,t),r=n.querySelector(".canvas-content"),e.previewComponent){const n=e.previewComponent.querySelector(".component-content");if(n&&n.dataset.currentVariant){const e=parseInt(n.dataset.currentVariant),a=o.querySelector(".component-content");if(a){const n=setupVariants(t);if(n&&n[e]){a.dataset.currentVariant=e,a.dataset.cachedVariants=JSON.stringify(n),a.innerHTML=n[e];const t=o.querySelector(".variant-number");t&&(t.textContent=`${e+1}/${n.length}`),this.setupIconPicker(a),this.setupImageUpload(a),this.setupResize(o),createColorSwatches(a)}}}}if(r){const e=r.querySelector("footer")?.closest(".component-container");e?r.insertBefore(o,e):r.appendChild(o)}requestAnimationFrame((()=>{o.querySelectorAll('[style*="background-color"]').forEach((e=>{window.TextContrastAdjuster.updateElementContrast(e)}))}))}if(!["navbar","bottomNav","modal"].includes(t)){const e=n.querySelector(".phoneScrollCon");e&&(e.scrollTop="hero"===t?0:e.scrollHeight)}!["navbar","bottomNav","modal"].includes(t)&&o&&(o.classList.add("component-add-animation"),o.addEventListener("animationend",(()=>{o.classList.remove("component-add-animation")}),{once:!0}))})):projectManager.showNotification("Select a screen to add a component","error")}isSpecialComponent(e){return Object.keys(this.specialComponents).includes(e)}hasSpecialComponent(e,t){let n=!1;switch(t){case"navbar":n=null!==e.querySelector(".navContain");break;case"bottomNav":n=null!==e.querySelector(".bottomNavContain");break;case"sidebar":n=null!==e.querySelector(".sidebar-container");break;case"modal":n=null!==e.querySelector(".modal-wrapper");break;case"floatingActionButton":n=null!==e.querySelector(".fab-container");break;default:n=!1}return"modal"===t&&(this.modalAdded=n),this.specialComponents[t]&&(this.specialComponents[t].added=n),n}insertSpecialComponent(e,t,n){const a=e.classList.contains("canvas")?e:e.querySelector(".canvas");if(!a)return void console.error("No canvas element found for inserting special component");const o=a.querySelector(".canvas-content");if(o||"modal"===n){switch(this.specialComponents[n].added=!0,t.outerHTML&&(this.specialComponents[n].content=t.outerHTML),n){case"navbar":a.insertBefore(t,a.firstChild);let e=o.querySelector(".navbar-spacer");e||(e=document.createElement("div"),e.className="navbar-spacer",e.style.height="54px",e.style.width="100%",o.insertBefore(e,o.firstChild)),t.style.cssText="position: absolute; left: 0; right: 0; top: 28px;",this.setupNavbar(t);break;case"bottomNav":a.appendChild(t),t.style.cssText="position: absolute; left: 0; right: 0; bottom: 0;",this.setupBottomNav(t);break;case"sidebar":a.appendChild(t),t.style.cssText="position: absolute; left: 0; top:0; bottom: 0; height:100%;";break;case"modal":a.appendChild(t),this.setupModal(t);break;case"floatingActionButton":a.appendChild(t)}this.setupImageUpload(t),this.setupIconPicker(t)}else console.error("No canvas content found in canvas")}removeSpecialComponent(e,t){t.forEach((t=>{const n=t.classList.contains("canvas")?t:t.querySelector(".canvas"),a=n?.querySelector(".canvas-content");switch(e){case"navbar":const e=n.querySelector(".navContain");if(e){e.remove();let t=a.querySelector(".navbar-spacer");t&&t.remove(),a.style.paddingTop="30px"}break;case"bottomNav":const t=n.querySelector(".bottomNavContain");t&&t.remove();break;case"sidebar":const o=n.querySelector(".sidebar-container");o&&o.remove();break;case"modal":const r=n.querySelector(".modal-wrapper");r&&r.remove();break;case"floatingActionButton":const s=n.querySelector(".fab-container");s&&s.remove()}this.specialComponents[e]&&(this.specialComponents[e].added=!1,this.specialComponents[e].content=null)}))}setupVariantControls(e,t,n){const a=setupVariants(n)||[],o=a.length||0;if(o<=1)return null;if(o>1){const r=document.createElement("div");r.classList="variant-controls";const s=document.createElement("button");s.innerHTML='<i class="fas fa-circle-left"></i>',s.className="nav-control prev-nav";const l=document.createElement("button");l.innerHTML='<i class="fas fa-circle-right"></i>',l.className="nav-control next-nav";const c=document.createElement("span");c.className="variant-number";const i=t.dataset.currentVariant?parseInt(t.dataset.currentVariant):0;c.textContent=`${i+1}/${o}`;const d=r=>{const s=parseInt(t.dataset.currentVariant,10)||0,l=(s+r+o)%o;if("blankCard"===n){const n=document.createElement("div");n.innerHTML=a[l];const o=n.firstChild,r=t.querySelector(".blank-card-content"),s=o.querySelector(".blank-card-content"),c=r.querySelector(".card-image");let i="";c&&(i=c.style.backgroundImage);const d=Array.from(r.children).filter((e=>!e.classList.contains("card-image")));if(r.style.cssText=s.style.cssText,r.className=s.className,s.classList.contains("hero")){const e=s.querySelector(".card-image").cloneNode(!0);i&&(e.style.backgroundImage=i,e.style.backgroundSize="cover",e.style.backgroundPosition="center",e.style.backgroundRepeat="no-repeat",e.innerHTML="",e.classList.add("with-image"),e.style.backgroundColor="transparent"),r.appendChild(e)}d.forEach((e=>r.appendChild(e)));const p=e.closest(".component-container");Array.from(p.children).filter((e=>e.classList.contains("color-swatch-container"))).forEach((e=>e.remove())),this.createColorSwatchesForVariant(e,t),window.updateComponentSwatches(e),t.dataset.currentVariant=l,this.setupImageUpload(t)}else{const o=t.dataset.variantCache?JSON.parse(t.dataset.variantCache):{};o[s]=t.innerHTML,t.dataset.variantCache=JSON.stringify(o),t.dataset.currentVariant=l;if(t.parentElement.querySelectorAll(".color-swatch-container").forEach((e=>e.remove())),t.querySelectorAll(".alignment-arrow").forEach((e=>e.remove())),o[l])t.innerHTML=o[l]||a[l];else{const e=document.createElement("div");e.innerHTML=a[l];const n=e.firstChild;t.innerHTML="",t.appendChild(n)}t.querySelectorAll("*").forEach((e=>{1!==e.childNodes.length||e.childNodes[0].nodeType!==Node.TEXT_NODE||e.classList.contains("non-editable")||e.setAttribute("contentEditable","true")})),this.setupInputListeners(t,n),"avatar"===n&&this.createAlignmentControlsForVariant(t,n),"progressBar"===n&&this.setupProgressBar(e,76),"blankCard"===n&&this.setupBlankCard(t),"imgGallery"===n&&setupImageGallery(t),this.createColorSwatchesForVariant(e,t),window.updateComponentSwatches(e),this.setupIconPicker(t),this.setupImageUpload(t),this.setupResize(e);const r=e.querySelectorAll(".resizeable");r.length&&r.forEach((e=>{resizer.makeResizable(e)}))}c.textContent=`${l+1}/${o}`,requestAnimationFrame((()=>{t.querySelectorAll('[style*="background-color"]').forEach((e=>{e&&TextContrastAdjuster.updateElementContrast(e)}))}))};return s.addEventListener("click",(()=>d(-1))),l.addEventListener("click",(()=>d(1))),r.appendChild(s),r.appendChild(c),r.appendChild(l),e.appendChild(r),r}return null}createColorSwatchesForVariant(e,t){t.querySelectorAll('[style*="var(--color"]').forEach((n=>{if(n.closest(".component-container")!==t.closest(".component-container"))return;const a=createColorSwatches(n);Array.isArray(a)?a.forEach((t=>{t&&t.children.length>0&&e.insertBefore(t,e.firstChild)})):a&&a.children.length>0&&e.insertBefore(a,e.firstChild)}))}createAlignmentControlsForVariant(e,t){if(["avatar","icon","floatingActionButton","image"].includes(t)){const t=e.querySelector(".align-content");t.querySelectorAll(".alignment-arrow").forEach((e=>e.remove()));const n=t.style.justifyContent||"center";createAlignmentControls(t).setAlignment(n)}}setupInputListeners(e,t){if("input"===t||"searchBar"===t){e.querySelectorAll("[contenteditable=true]").forEach((e=>{e.addEventListener("input",(function(){""===this.textContent.trim()?this.classList.add("empty"):this.classList.remove("empty")})),e.addEventListener("keypress",(e=>{"Enter"===e.key&&e.preventDefault()})),e.addEventListener("paste",(e=>{e.preventDefault();const t=(e.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,t)}))}))}if("textarea"===t){e.querySelectorAll("[contenteditable=true]").forEach((e=>{e.addEventListener("input",(function(){""===this.textContent.trim()?this.classList.add("empty"):this.classList.remove("empty")}))}))}}setupNavbar(e){if(!e)return null;const t=e.classList.contains("navContain")?e:e.querySelector(".navContain");if(!t)return null;const n=t.querySelector(".navbar");if(!n)return null;this.topNavbarAdded=!0;const a=t.querySelector(".prev-nav"),o=t.querySelector(".next-nav"),r={content:['<span spellcheck="false" style="font-size: 20px; font-weight: bold; color: var(--color-primary);">Brand</span>\n            <div style="display: flex; align-items: center;">\n                <a href="#" style="margin-left: 20px; color: var(--basic-txt-color); text-decoration: none;">Home</a>\n                <a href="#" style="margin-left: 20px; color: var(--basic-txt-color); text-decoration: none;">About</a>\n                <a href="#" style="margin-left: 20px; color: var(--basic-txt-color); text-decoration: none;">Contact</a>\n                <div class="icon-container" style="margin-left: 20px;">\n                    <i class="fas fa-bars" style="font-size: 20px; color: var(--color-primary); cursor: pointer;"></i>\n                </div>\n            </div>','<div style="flex: 1; background-color: var(--color-background);"></div>\n            <div style="width: 40px; height: 40px; background-color: var(--neutral-gray); border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer;" class="nav-image">\n                <span class="non-editable"><i class="fas fa-image"></i></span>\n            </div>\n            <div style="flex: 1; display: flex; justify-content: flex-end;" class="icon-container">\n                <i class="fas fa-bars" style="font-size: 24px; color: var(--color-primary); cursor: pointer;"></i>\n            </div>','<div class="icon-container">\n                <i class="fas fa-arrow-left" style="font-size: 20px; color: var(--basic-txt-color); margin-right: 15px; cursor: pointer;"></i>\n            </div>\n            <div style="width: 100%; display: flex; justify-content: center;">\n                <span spellcheck="false" style="font-size: 24px; font-weight: bold; color: var(--basic-txt-color);">Brand</span>\n            </div>\n            <div class="icon-container">\n                <i class="fas fa-bars" style="font-size: 20px; color: var(--basic-txt-color); margin-right: 15px; cursor: pointer;"></i>\n            </div>','<div style="display: flex; align-items: center; width: 100%; padding: 0 10px;">\n                <div class="icon-container">\n                    <i class="fas fa-arrow-left" style="font-size: 20px; color: var(--color-primary); margin-right: 15px; cursor: pointer;"></i>\n                </div>\n                <div style="width: 40px; height: 40px; background-color: var(--color-transparent-blk); border-radius: 50%; margin-right: 15px; display: flex; justify-content: center; align-items: center; cursor: pointer;" class="nav-image">\n                    <span class="non-editable"><i class="fas fa-image"></i></span>\n                </div>\n                <div style="flex: 1;">\n                    <span style="display: block; font-weight: bold; color: var(--color-primary);">Username</span>\n                    <span class="status" style="font-size: 14px; color: #27ae60; cursor: pointer;">Online</span>\n                </div>\n                <div style="display: flex; gap: 20px;">\n                    <div class="icon-container">\n                        <i class="fas fa-phone" style="font-size: 20px; color: var(--color-primary); cursor: pointer;"></i>\n                    </div>\n                    <div class="icon-container">\n                        <i class="fas fa-ellipsis-vertical" style="font-size: 20px; color: var(--color-primary); cursor: pointer;"></i>\n                    </div>\n                </div>\n            </div>'],cached:[]};let s=0;s=(()=>{const e=n.innerHTML.trim();return e.includes('class="status"')?3:e.includes("fa-arrow-left")&&e.includes("justify-content: center")?2:e.includes("nav-image")&&!e.includes("fa-arrow-left")?1:0})(),r.cached=[...r.content],r.cached[s]=n.innerHTML;const l=e=>{r.cached[s]=n.innerHTML,s=e,n.innerHTML=r.cached[s],n.style.backgroundColor=2===s?"var(--color-primary)":"var(--color-background)",this.setupInteractiveElements(n)};if(a&&o){const e=a.cloneNode(!0),n=o.cloneNode(!0);a.parentNode&&a.parentNode.replaceChild(e,a),o.parentNode&&o.parentNode.replaceChild(n,o),e.addEventListener("click",(()=>{const e=(s-1+r.cached.length)%r.cached.length;l(e)})),n.addEventListener("click",(()=>{const e=(s+1)%r.cached.length;l(e)})),t.addEventListener("mouseenter",(()=>{e.style.opacity="1",n.style.opacity="1"})),t.addEventListener("mouseleave",(()=>{e.style.opacity="0",n.style.opacity="0"}))}return new MutationObserver((()=>{r.cached[s]=n.innerHTML})).observe(n,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),this.setupInteractiveElements(n),t}setupInteractiveElements(e){if(e)return e.querySelectorAll("span:not(.non-editable), a").forEach((e=>{e.addEventListener("keypress",(t=>{"Enter"===t.key&&(t.preventDefault(),e.blur())})),e.addEventListener("paste",(e=>{e.preventDefault();const t=(e.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,t)}))})),setTimeout((()=>{e.querySelectorAll('[style*="background-color"]').forEach((e=>{window.TextContrastAdjuster&&window.TextContrastAdjuster.updateElementContrast(e)}))}),10),e}setupInteractiveElements(e){if(!e)return;e.querySelectorAll("span:not(.non-editable), a").forEach((e=>{e.contentEditable=!0,e.addEventListener("keypress",(t=>{"Enter"===t.key&&(t.preventDefault(),e.blur())})),e.addEventListener("paste",(e=>{e.preventDefault();const t=(e.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,t)}))})),e.querySelectorAll('.icon-container i, i[class*="fa-"]').forEach((e=>{e.style.cursor="pointer",e.getAttribute("data-icon-handler")||(e.setAttribute("data-icon-handler","true"),e.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),showIconPicker(e)})))})),e.querySelectorAll(".nav-image").forEach((e=>{e.getAttribute("data-upload-handler")||(e.setAttribute("data-upload-handler","true"),e.addEventListener("click",(()=>{const t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=t=>{const n=t.target.files[0];if(n){const t=new FileReader;t.onload=t=>{e.style.backgroundImage=`url(${t.target.result})`,e.style.backgroundSize="cover",e.style.backgroundPosition="center",e.innerHTML="",e.classList.add("with-image")},t.readAsDataURL(n)}},t.click()})))}));return e.querySelectorAll('[style*="var(--color"]').forEach((t=>{const n=createColorSwatches(t);if(n){const a=t.closest(".component-container")||e.closest(".component-container");a&&a.appendChild(n)}})),setTimeout((()=>{e.querySelectorAll('[style*="background-color"]').forEach((e=>{window.TextContrastAdjuster&&window.TextContrastAdjuster.updateElementContrast(e)}))}),100),e}updateHeadingLevel(e,t){const n=["h1","h2","h3","h4","h5","h6"];let a;const o=e.querySelector("h1, h2, h3, h4, h5, h6");if(!o)return;const r=o.tagName.toLowerCase();a=n.indexOf(r),a="string"==typeof t&&n.includes(t.toLowerCase())?n.indexOf(t.toLowerCase()):(t+n.length)%n.length;const s=n[a],l=document.createElement(s);l.textContent=o.textContent,l.style.cssText=o.style.cssText,l.setAttribute("contentEditable","true"),o.classList.contains("usa")&&l.classList.add("usa");const c=e.querySelector(".level-indicator");return c&&(c.textContent=s.toUpperCase()),o.parentNode.replaceChild(l,o),e.dataset.headingLevel=s,l}setupBottomNav(e){if(!e)return null;const t=e.querySelector(".bottomNav");if(!t)return null;this.bottomNavbarAdded=!0;t.querySelectorAll(".nav-item-container").forEach((n=>{const o=n.querySelector(".nav-delete-btn");if(o){const n=o.cloneNode(!0);o.parentNode.replaceChild(n,o),n.addEventListener("click",(function(){t.querySelectorAll(".nav-item-container").length>1&&(this.closest(".nav-item-container").remove(),a(e))}))}const r=n.querySelector("i");r&&(r.style.cursor="pointer",r.addEventListener("click",(e=>{e.preventDefault(),showIconPicker(r)})));const s=n.querySelector("span");s&&this.makeTextEditable(s)}));const n=t.querySelector(".nav-add-btn");if(n){const o=n.cloneNode(!0);n.parentNode&&n.parentNode.contains(n)?(n.parentNode.replaceChild(o,n),o.addEventListener("click",(()=>{if(t.querySelectorAll(".nav-item-container").length<5){const n=document.createElement("div");n.className="nav-item-container",n.innerHTML='\n                            <button class="nav-delete-btn">×</button>\n                            <a href="#" class="bottom-nav-item">\n                                <i class="fa-solid fa-bolt-lightning" ></i>\n                                <span contenteditable="true">New</span>\n                            </a>\n                        ',n.querySelector(".nav-delete-btn").addEventListener("click",(function(){t.querySelectorAll(".nav-item-container").length>1&&(this.closest(".nav-item-container").remove(),a(e))})),n.querySelector("i").addEventListener("click",(e=>{e.preventDefault(),showIconPicker(e.target)})),this.makeTextEditable(n.querySelector("span")),t.contains(o)?t.insertBefore(n,o):t.appendChild(n),a(e)}}))):t&&(t.appendChild(o),o.addEventListener("click",(()=>{if(t.querySelectorAll(".nav-item-container").length<5){const n=document.createElement("div");n.className="nav-item-container",n.innerHTML='\n                                <button class="nav-delete-btn">×</button>\n                                <a href="#" class="bottom-nav-item">\n                                    <i class="fa-solid fa-bolt-lightning" ></i>\n                                    <span contenteditable="true">New</span>\n                                </a>\n                            ',n.querySelector(".nav-delete-btn").addEventListener("click",(function(){t.querySelectorAll(".nav-item-container").length>1&&(this.closest(".nav-item-container").remove(),a(e))})),n.querySelector("i").addEventListener("click",(e=>{e.preventDefault(),showIconPicker(e.target)})),this.makeTextEditable(n.querySelector("span")),t.appendChild(n),a(e)}})))}else{const n=document.createElement("button");n.className="nav-add-btn",n.innerHTML='<i class="fas fa-plus"></i>',n.addEventListener("click",(()=>{if(t.querySelectorAll(".nav-item-container").length<5){const n=document.createElement("div");n.className="nav-item-container",n.innerHTML='\n                        <button class="nav-delete-btn">×</button>\n                        <a href="#" class="bottom-nav-item">\n                            <i class="fa-solid fa-bolt-lightning" ></i>\n                            <span contenteditable="true">New</span>\n                        </a>\n                    ',n.querySelector(".nav-delete-btn").addEventListener("click",(function(){t.querySelectorAll(".nav-item-container").length>1&&(this.closest(".nav-item-container").remove(),a(e))})),n.querySelector("i").addEventListener("click",(e=>{e.preventDefault(),showIconPicker(e.target)})),this.makeTextEditable(n.querySelector("span")),t.appendChild(n),a(e)}})),t.appendChild(n)}function a(e){try{if(!e)return;const t=e.querySelector(".bottomNav");if(!t)return;const n=t.querySelectorAll(".nav-item-container").length,a=t.querySelector(".nav-add-btn");a&&(n>=5?(e.classList.add("max-items"),a.style.display="none"):(e.classList.remove("max-items"),a.style.display="none"))}catch(e){console.error("Error in updateAddButtonVisibility:",e)}}return e.querySelectorAll('[style*="var(--color"]').forEach((t=>{const n=createColorSwatches(t);n&&e.appendChild(n)})),e.addEventListener("mouseenter",(()=>{const n=t.querySelector(".nav-add-btn");n&&!e.classList.contains("max-items")&&(n.style.display="block")})),e.addEventListener("mouseleave",(()=>{const e=t.querySelector(".nav-add-btn");e&&(e.style.display="none")})),e}setupSidebar(e){if(!e)return null;const t=e.querySelector(".sidebar-panel"),n=t?.querySelector(".sidebar-toggle"),a=t?.querySelector(".sidebar-nav"),o=t?.querySelector(".sidebar-add-btn");if(!t||!a)return null;const r=(e="bolt-lightning",t="New Item")=>{const n=document.createElement("div");n.className="icon-container";const a=document.createElement("div");a.className="sidebar-nav-item";const o=document.createElement("i");o.className=`fas fa-${e}`,o.style.cssText="\n            width: 20px;\n            text-align: center;\n            color: var(--color-primary);\n        ";const r=document.createElement("span");r.textContent=t,r.setAttribute("contenteditable","true"),r.style.flex="1";const s=document.createElement("button");return s.className="nav-item-delete",s.innerHTML="×",a.addEventListener("mouseenter",(()=>{a.style.outline="2px solid var(--neutral-gray)",s.style.display="block",setTimeout((()=>s.style.opacity="1"),0)})),a.addEventListener("mouseleave",(()=>{a.style.outline="none",s.style.opacity="0"})),s.addEventListener("click",(e=>{e.stopPropagation(),a.classList.add("delete-animation"),setTimeout((()=>a.remove()),200)})),a.appendChild(o),a.appendChild(r),a.appendChild(s),n.appendChild(a),this.setupIconPicker(n),n};if(a.querySelectorAll(".sidebar-nav-item").forEach((e=>{const t=e.querySelector(".nav-item-delete");if(t){const n=t.cloneNode(!0);t.parentNode.replaceChild(n,t),n.addEventListener("click",(t=>{t.stopPropagation(),e.classList.add("delete-animation"),setTimeout((()=>e.remove()),200)}))}e.addEventListener("mouseenter",(()=>{e.style.outline="2px solid var(--neutral-gray)";const t=e.querySelector(".nav-item-delete");t&&(t.style.display="block",setTimeout((()=>t.style.opacity="1"),0))})),e.addEventListener("mouseleave",(()=>{e.style.outline="none";const t=e.querySelector(".nav-item-delete");t&&(t.style.opacity="0")}))})),o){const t=o.cloneNode(!0);o.parentNode&&o.parentNode.replaceChild(t,o),t.addEventListener("click",(()=>{const e=r();a.appendChild(e)})),e.addEventListener("mouseenter",(()=>{t.style.display="flex"})),e.addEventListener("mouseleave",(()=>{t.style.display="none"}))}if(n){const a=n.cloneNode(!0);n.parentNode.replaceChild(a,n);let o=!1;a.addEventListener("click",(()=>{o=!o,o?(t.style.transform="translateX(-182px)",a.style.transform="translateY(-50%) rotate(180deg)",e.style.width="8px"):(t.style.transform="translateX(0)",a.style.transform="translateY(-50%) rotate(0deg)",e.style.width="240px")}))}return e}setupFloatingActionButton(e){if(!e)return null;if(!e.querySelector(".fab-nav"))return null;e.querySelectorAll(".alignment-arrow").forEach((e=>e.remove()));const t=createAlignmentControls(e),n=e.style.justifyContent||"center";t.setAlignment(n),t.hideArrows();const a=e._eventHandlers||{};return a.mouseenter&&e.removeEventListener("mouseenter",a.mouseenter),a.mouseleave&&e.removeEventListener("mouseleave",a.mouseleave),a.mouseenter=()=>{e.style.pointerEvents="auto",t.updateArrowVisibility()},a.mouseleave=()=>{e.style.pointerEvents="none",t.hideArrows()},e.addEventListener("mouseenter",a.mouseenter),e.addEventListener("mouseleave",a.mouseleave),e._eventHandlers=a,e}setupModal(e){if(!e)return;const t=e.querySelector('div[style*="width: calc(100% - 46px)"]'),n=t?.querySelector("div");return n&&n.addEventListener("click",(()=>{this.modalAdded=!1,this.specialComponents.modal.added=!1;const t=e.closest(".canvas");t&&t.removeAttribute("data-has-modal"),e.remove()})),this.modalAdded=!0,e}setupNotificationBanner(e){const t=e.querySelector(".notification-action-btn"),n=e.querySelector(".noti-visibility-toggle");if(t&&n){n.replaceWith(n.cloneNode(!0));const a=e.querySelector(".noti-visibility-toggle");a.addEventListener("click",(()=>{const e="true"===t.dataset.alwaysVisible;t.dataset.alwaysVisible=(!e).toString(),t.style.display=e?"none":"block",a.innerHTML=e?'<i class="fas fa-eye-slash"></i>':'<i class="fas fa-eye"></i>'}))}}setupVideoEmbed(e){const t=e.querySelector(".video-embed-container");if(!t)return;const n=t.querySelector('input[type="text"]'),a=t.querySelector(".embed-video-btn"),o=t.querySelector(".video-placeholder"),r=t.querySelector(".embedded-video");if(a&&n){a.replaceWith(a.cloneNode(!0));t.querySelector(".embed-video-btn").addEventListener("click",(()=>{const e=n.value.trim();let t;e.includes("youtube.com")||e.includes("youtu.be")?(t=e.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/)?.[1],t&&(r.innerHTML=`\n                            <iframe \n                                width="100%" \n                                height="100%" \n                                src="https://www.youtube.com/embed/${t}" \n                                frameborder="0" \n                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" \n                                allowfullscreen>\n                            </iframe>`)):e.includes("vimeo.com")&&(t=e.match(/vimeo\.com\/(\d+)/)?.[1],t&&(r.innerHTML=`\n                            <iframe \n                                width="100%" \n                                height="100%" \n                                src="https://player.vimeo.com/video/${t}" \n                                frameborder="0" \n                                allow="autoplay; fullscreen; picture-in-picture" \n                                allowfullscreen>\n                            </iframe>`)),t?(o.style.display="none",r.style.display="block"):alert("Please enter a valid YouTube or Vimeo URL")}))}}setupAccordionContent=e=>{if(!e)return;const t=e.parentElement?.querySelector(".accordion-header");if(t){const e=t.cloneNode(!0);t.parentNode.replaceChild(e,t)}new MutationObserver((()=>{"0px"!==e.style.height&&""!==e.style.height?(e.style.padding="8px 12px 0 12px",e.style.height=e.scrollHeight-8+"px"):e.style.padding="0 12px";const t=e.querySelector(".component-container"),n=e.querySelector(".placeholder");t&&n?n.remove():t||n||(e.innerHTML='\n      <div class="placeholder" style="padding: 18px 0;">\n        <div>\n          <p class="non-editable" style="margin: 0 24px; color: #666;">drag & drop components here.</p>\n        </div>\n      </div>\n    ')})).observe(e,{childList:!0,subtree:!0,attributes:!0});const n=e.parentElement?.querySelector(".accordion-header"),a=n?.querySelector(".fa-chevron-down");n&&a&&n.addEventListener("click",(()=>{"0px"!==e.style.height&&""!==e.style.height?(e.style.height="0",a.style.transform="rotate(0)"):(e.style.height=e.scrollHeight+"px",a.style.transform="rotate(180deg)")})),this.initializeSortable(e)};setupFeatureComparisonCard(e){if(!e)return;const t=e.querySelector(".comparison-card-header"),n=e.querySelector(".comparison-card-grid"),a=e.querySelector(".comparison-add-row-btn");if(!n||!a)return void console.warn("Feature comparison card is missing required elements",{grid:n,addRowBtn:a});const o=(e="New Feature",t=!1)=>{const a=document.createElement("div");a.className="comparison-card-row";const o=document.createElement("button");o.innerHTML='<i class="fas fa-trash"></i>',o.className="delete-fc-row";const s=document.createElement("div");s.style.cssText="display: flex; align-items: center; gap: 8px; width: 100%;";const l=document.createElement("span");l.textContent=e,l.setAttribute("contenteditable","true"),s.appendChild(l),s.appendChild(o),a.appendChild(s),a.addEventListener("mouseenter",(()=>o.style.display="block")),a.addEventListener("mouseleave",(()=>o.style.display="none"));const c=document.createElement("div");c.innerHTML=t?'<i class="fas fa-times" style="color: #999;"></i>':'<i class="fas fa-check" style="color: green;"></i>',c.style.cssText="text-align: center; cursor: pointer;";const i=document.createElement("div");return i.innerHTML='<i class="fas fa-check" style="color: green;"></i>',i.style.cssText="text-align: center; cursor: pointer;",[c,i].forEach((e=>{e.onclick=()=>{const t=null!==e.querySelector(".fa-check");e.innerHTML=t?'<i class="fas fa-times" style="color: #999;"></i>':'<i class="fas fa-check" style="color: green;"></i>'}})),o.onclick=e=>{e.stopPropagation(),[a,c,i].forEach((e=>e.remove())),r()},n.appendChild(a),n.appendChild(c),n.appendChild(i),[a,c,i]},r=()=>{const e=Array.from(n.children).filter((e=>"Features"===e.textContent||"Basic"===e.textContent||"Pro"===e.textContent));(n.children.length-e.length)/3>=20?(a.style.opacity="0.5",a.style.cursor="not-allowed"):(a.style.opacity="1",a.style.cursor="pointer")};a.replaceWith(a.cloneNode(!0));const s=e.querySelector(".comparison-add-row-btn");s.addEventListener("click",(()=>{const e=Array.from(n.children).filter((e=>"Features"===e.textContent||"Basic"===e.textContent||"Pro"===e.textContent));(n.children.length-e.length)/3<20&&(o("New Feature",!0),r())})),e.addEventListener("mouseenter",(()=>{s.style.display="block"})),e.addEventListener("mouseleave",(()=>{s.style.display="none"})),t&&t.setAttribute("contenteditable","true");const l=[];Array.from(n.children).filter((e=>e.classList.contains("comparison-card-row"))).forEach(((e,t)=>{const a=n.children[3*t+1+3],o=n.children[3*t+2+3];if(a&&o){[a,o].forEach((e=>{e.onclick=()=>{const t=null!==e.querySelector(".fa-check");e.innerHTML=t?'<i class="fas fa-times" style="color: #999;"></i>':'<i class="fas fa-check" style="color: green;"></i>'}}));const t=e.querySelector(".delete-fc-row");t&&(t.onclick=t=>{t.stopPropagation(),[e,a,o].forEach((e=>e.remove())),r()}),e.addEventListener("mouseenter",(()=>{const t=e.querySelector(".delete-fc-row");t&&(t.style.display="block")})),e.addEventListener("mouseleave",(()=>{const t=e.querySelector(".delete-fc-row");t&&(t.style.display="none")})),l.push([e,a,o])}}));return Array.from(n.children).slice(0,3).forEach((e=>{e&&e.setAttribute("contenteditable","true")})),r(),{createFeatureRow:o,updateAddButtonState:r}}setupPagination(e){if(!e)return null;const t=e.querySelectorAll(".page-btn:not(.prev-page):not(.next-page)"),n=e.querySelector(".prev-page"),a=e.querySelector(".next-page");let o=null;if(t.forEach((e=>{e.classList.contains("selected")&&(o=e)})),!o&&t.length>0&&(o=t[0],o.classList.add("selected"),o.style.background="var(--color-primary)",o.style.color="var(--basic-txt-color)"),t.forEach((t=>{t.onclick=function(n){o&&(o.classList.remove("selected"),o.style.background="var(--neutral-gray)",o.style.color="var(--basic-txt-color)"),t.classList.add("selected"),t.style.background="var(--color-primary)",t.style.color="var(--basic-txt-color)",o=t;e.querySelectorAll(".color-swatch-container").forEach((e=>e.remove()));const a=createColorSwatches(t);a&&(Array.isArray(a)?a.forEach((t=>{t&&e.insertBefore(t,e.firstChild)})):e.insertBefore(a,e.firstChild)),n.preventDefault()},t.addEventListener("keydown",(function(e){"Enter"===e.key&&(e.preventDefault(),this.blur())}))})),n&&(n.onclick=function(e){if(!o)return;const n=Array.from(t),a=n.indexOf(o);a>0&&n[a-1].click(),e.preventDefault()}),a&&(a.onclick=function(e){if(!o)return;const n=Array.from(t),a=n.indexOf(o);a<n.length-1&&n[a+1].click(),e.preventDefault()}),o){const t=createColorSwatches(o);t&&(Array.isArray(t)?t.forEach((t=>{t&&e.insertBefore(t,e.firstChild)})):e.insertBefore(t,e.firstChild))}return{getSelectedButton:()=>o}}setupProgressTracker(e){if(!e)return;e.querySelectorAll(".color-swatch-container").forEach((e=>e.remove()));let t=e.querySelector(".steps-container");if(!t){t=document.createElement("div"),t.className="steps-container",t.style.cssText="display: flex; align-items: center; width: 100%; position: relative;";Array.from(e.querySelectorAll("[data-step]")).forEach((e=>t.appendChild(e)));const n=e.querySelector(".progress-tracker-controls");n?e.insertBefore(t,n):e.appendChild(t)}let n=null;const a=e.querySelector("[data-step].selected-step");function o(t){e.querySelectorAll("[data-step]").forEach((e=>{e.classList.remove("selected-step");const t=e.querySelector(".step-circle");t&&(t.style.backgroundColor="var(--neutral-gray)",t.style.color="#666")})),t.classList.add("selected-step");const a=t.querySelector(".step-circle");a&&(a.style.backgroundColor="var(--color-primary)",a.style.color="var(--basic-txt-color)"),n=t;e.querySelectorAll(".color-swatch-container").forEach((e=>e.remove())),r(t)}function r(t){if(!t)return;const n=t.querySelector(".step-circle");if(!n)return;const a=createColorSwatches(n);a&&a.children&&a.children.length>0&&e.insertBefore(a,e.firstChild),window.updateComponentSwatches(e)}function s(){t.querySelectorAll(".connecting-line").forEach((e=>e.remove()));const e=t.querySelectorAll("[data-step]");e.forEach(((n,a)=>{if(a<e.length-1){const n=function(){const e=document.createElement("div");return e.style.cssText="height: 2px; background-color: #E0E0E0; flex: 1; margin: 18px 0 0 0; align-self: flex-start; border-radius: 2px",e.classList.add("connecting-line"),e}();t.insertBefore(n,e[a+1])}}))}function l(){t.querySelectorAll("[data-step]").forEach(((e,t)=>{const n=e.querySelector(".step-circle");n&&(n.textContent=(t+1).toString())})),s(),function(){const n=e.querySelector(".progress-tracker-controls");if(!n)return;const a=t.querySelectorAll("[data-step]"),o=n.querySelector("button:first-child"),r=n.querySelector("button:last-child");o&&r&&(o.style.opacity=1===a.length?"0.5":"1",o.style.cursor=1===a.length?"default":"pointer",r.style.opacity=5===a.length?"0.5":"1",r.style.cursor=5===a.length?"default":"pointer")}()}a?n=a:(n=e.querySelector("[data-step]"),n&&n.classList.add("selected-step"));const c=e.querySelector(".progress-tracker-controls");if(c){const e=c.querySelector("button:last-child"),a=c.querySelector("button:first-child");if(e){const a=e.cloneNode(!0);e.parentNode&&e.parentNode.replaceChild(a,e),a.onclick=()=>{const e=t.querySelectorAll("[data-step]");if(e.length<7){const a=function(e){const t=document.createElement("div");t.className="step-container",t.style.cssText="display: flex; flex-direction: column; align-items: center; gap: 8px; z-index: 2; flex: 0 1 auto; text-align: center; cursor: pointer;",t.setAttribute("data-step","");const a=document.createElement("div");a.className="step-circle",a.style.cssText=`\n            width: 36px;\n            height: 36px;\n            border-radius: 50%;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            font-weight: bold;\n            margin: 0 6px;\n            ${0===e?"background-color: var(--color-primary);":"background-color: var(--neutral-gray); color: #666;"}\n        `,a.textContent=(e+1).toString(),a.setAttribute("contentEditable","true");const r=document.createElement("div");return r.className="step-label",r.textContent=`Step ${e+1}`,r.style.cssText="font-size: 14px; color: #666; font-weight: 500;",r.setAttribute("contentEditable","true"),t.appendChild(a),t.appendChild(r),t.style.cursor="pointer",0!==e||n||(n=t,t.classList.add("selected-step")),t.addEventListener("click",(()=>{o(t)})),t}(e.length);t.appendChild(a),l()}}}if(a){const e=a.cloneNode(!0);a.parentNode&&a.parentNode.replaceChild(e,a),e.onclick=()=>{const e=t.querySelectorAll("[data-step]");if(e.length>1){const t=e[e.length-1];n===t&&(n=e[e.length-2],o(n)),t.remove(),l()}}}}const i=e.querySelectorAll("[data-step]");i.forEach((e=>{const t=e.querySelector(".step-circle");t&&t.style.backgroundColor.includes("--color-primary")&&(n=e,e.classList.add("selected-step")),e.addEventListener("click",(()=>{o(e)}))})),!n&&i.length>0&&(n=i[0],o(n)),l(),n&&r(n)}setupBlankCard(e){const t=e.querySelector(".blank-card-content");let n=t.querySelector(".empty-placeholder");n||(n=document.createElement("div"),n.className="empty-placeholder",n.classList.add("non-editable"),n.textContent="drag & drop components here",n.style.cssText="position: absolute; top: 50%; left: 50%;  font-style: italic; pointer-events: none;",t.appendChild(n));new MutationObserver((e=>{e.forEach((e=>{if("childList"===e.type){const e=t.querySelector(".component-container");n.style.display=e?"none":"block"}}))})).observe(t,{childList:!0,subtree:!0}),this.initializeSortable(t)}setupChipGroup(e){if(!e)return;const t=e.querySelector(".chip-group-container"),n=e.querySelector(".add-chip-btn");if(!t||!n)return;n.replaceWith(n.cloneNode(!0));const a=e.querySelector(".add-chip-btn");new Sortable(t,{animation:150,ghostClass:"chip-ghost",chosenClass:"chip-chosen",dragClass:"chip-drag",onEnd:function(){t.querySelectorAll(".chip").forEach((e=>{e.classList.add("reorder-flash"),setTimeout((()=>e.classList.remove("reorder-flash")),300)}))}});const o=e=>{const n=e.cloneNode(!0);e.replaceWith(n);const a=n.querySelector("span"),o=n.querySelector(".remove-chip");a&&(a.setAttribute("contentEditable","true"),a.className="usa"),n.addEventListener("click",(e=>{if(e.target!==o&&e.target!==a){if("true"===n.getAttribute("data-selected"))n.style.backgroundColor="var(--neutral-gray)",n.setAttribute("data-selected","false");else{let e="var(--color-primary)";const a=t.querySelectorAll('.chip[data-selected="true"]');if(a.length>0){e=window.getComputedStyle(a[0]).backgroundColor}n.style.backgroundColor=e,n.setAttribute("data-selected","true")}requestAnimationFrame((()=>{window.TextContrastAdjuster.updateElementContrast(n)}))}})),o&&o.addEventListener("click",(e=>{e.stopPropagation(),n.remove()})),n.setAttribute("tabindex","0"),n.addEventListener("keydown",(e=>{"Enter"===e.key&&(n.click(),e.preventDefault())}))};a.addEventListener("click",(()=>{if(t.children.length<25){let e="var(--neutral-gray)";const n=t.querySelectorAll(".chip");if(n.length>0){const t=n[0],a=window.getComputedStyle(t).backgroundColor;e=a.includes("rgb")?"var(--neutral-gray)":a}const a=document.createElement("div");a.className="chip",a.style.backgroundColor=e;const r=document.createElement("span");r.textContent="New Pill",r.setAttribute("contentEditable","true"),a.setAttribute("data-selected","false");const s=document.createElement("i");s.className="fas fa-times remove-chip",a.appendChild(r),a.appendChild(s),t.appendChild(a),o(a),requestAnimationFrame((()=>{window.TextContrastAdjuster.updateElementContrast(a)}))}})),t.querySelectorAll(".chip").forEach(o)}setupDatePicker(e,t,n,a){t.addEventListener("input",(()=>{t.style.opacity="1"})),n.addEventListener("click",(()=>{a.style.display="none"===a.style.display?"block":"none"})),e.querySelectorAll(".date-picker-day-cell").forEach((n=>{n.addEventListener("click",(()=>{const o=e.querySelector(".date-picker-month-text").textContent,r=e.querySelector(".date-picker-year-text").textContent;t.textContent=`${o} ${n.textContent}, ${r}`,a.style.display="none",t.style.opacity="1"}))}))}setupBulletedList(e){if(!e)return;let t=e.querySelector(".bulleted-list-container");const n=e.querySelector(".bullet-list-add-btn");if(!t){t=document.createElement("div"),t.className="bulleted-list-container",t.style.cssText="display: flex; flex-direction: column; gap: 5px; width: 100%;";Array.from(e.querySelectorAll(".bullet-list-item")).forEach((e=>t.appendChild(e))),n?e.insertBefore(t,n):e.appendChild(t)}const a=e=>{let a=e.querySelector(".bullet-list-item-controls");if(!a){a=document.createElement("div"),a.className="bullet-list-item-controls";const t=document.createElement("i");t.className="fas fa-indent bullet-list-indent-btn";const n=document.createElement("i");n.className="fas fa-outdent bullet-list-outdent-btn";const o=document.createElement("i");o.className="fas fa-times bullet-list-delete-btn",a.appendChild(t),a.appendChild(n),a.appendChild(o),e.appendChild(a)}const o=a.querySelector(".bullet-list-indent-btn"),r=a.querySelector(".bullet-list-outdent-btn"),s=a.querySelector(".bullet-list-delete-btn");e.addEventListener("mouseenter",(()=>{a.style.display="flex"})),e.addEventListener("mouseleave",(()=>{a.style.display="none"})),o&&o.addEventListener("click",(()=>{const t=parseInt(e.style.marginLeft||"0");t<160&&(e.style.marginLeft=`${t+40}px`)})),r&&r.addEventListener("click",(()=>{const t=parseInt(e.style.marginLeft||"0");t>=40&&(e.style.marginLeft=t-40+"px")})),s&&s.addEventListener("click",(()=>{e.remove(),t.children.length<=20&&n&&(n.style.opacity="1",n.style.pointerEvents="all")}))};if(t.querySelectorAll(".bullet-list-item").forEach((e=>{if(e._handlers){e.removeEventListener("mouseenter",e._handlers.mouseEnter),e.removeEventListener("mouseleave",e._handlers.mouseLeave);const t=e.querySelector(".bullet-list-item-controls");if(t){const n=t.querySelector(".bullet-list-indent-btn"),a=t.querySelector(".bullet-list-outdent-btn"),o=t.querySelector(".bullet-list-delete-btn");n&&e._handlers.indent&&n.removeEventListener("click",e._handlers.indent),a&&e._handlers.unindent&&a.removeEventListener("click",e._handlers.unindent),o&&e._handlers.delete&&o.removeEventListener("click",e._handlers.delete)}delete e._handlers}})),t.querySelectorAll(".bullet-list-item").forEach(a),n){const e=n.cloneNode(!0);n.parentNode&&n.parentNode.replaceChild(e,n),e.addEventListener("click",(()=>{const n=document.createElement("div");n.className="bullet-list-item",n.innerHTML='\n                <div class="bullet-list-item-icon icon-container">\n                    <i class="fas fa-circle" style="font-size: 12px; margin-top: 1px; color: var(--basic-txt-color);"></i>\n                </div>\n                <div class="bullet-list-item-text" contenteditable="true">New item</div>\n            ';const o=n.querySelector(".icon-container"),r=o.querySelector("i");o.addEventListener("click",(()=>{showIconPicker(r)})),a(n),t.appendChild(n),t.children.length>20&&(e.style.opacity=".45",e.style.pointerEvents="none")}))}}setupTabs(e){if(!e)return;const t=e.querySelector(".tabs-wrapper"),n=e.querySelector(".tabs-controls"),a=n?.querySelector(".tabs-add-btn"),o=n?.querySelector(".tabs-remove-btn");if(!(t&&n&&a&&o))return;const r=n=>{t.querySelectorAll(".ui-tab").forEach((e=>{e.classList.remove("selected"),e.style.backgroundColor="var(--neutral-gray)",e.style.color="var(--basic-txt-color)"})),n.classList.add("selected"),n.style.backgroundColor="var(--color-primary)",n.style.color="var(--basic-txt-color)";const a=e.querySelectorAll('[style*="var(--color"]');if(a.length>0){e.querySelectorAll(".color-swatch-container").forEach((e=>e.remove())),a.forEach((t=>{try{const n=createColorSwatches(t);Array.isArray(n)?n.forEach((t=>{t&&t.children.length>0&&e.insertBefore(t,e.firstChild)})):n&&n.children.length>0&&e.insertBefore(n,e.firstChild)}catch(e){console.error("Error creating swatches:",e)}}))}else console.log("No color elements found in container")};t.querySelectorAll(".ui-tab").forEach((e=>{e.addEventListener("click",(()=>r(e))),e.classList.contains("selected")&&(r(e),window.TextContrastAdjuster.updateElementContrast(e))})),a.addEventListener("click",(()=>{if(t.children.length<5){const e=s(t.children.length+1);t.appendChild(e),r(e)}})),o.addEventListener("click",(()=>{if(t.children.length>1){t.removeChild(t.lastChild);const e=t.lastChild;e&&r(e)}}));const s=e=>{const t=document.createElement("div");return t.textContent=`Tab ${e}`,t.setAttribute("contentEditable","true"),t.className="ui-tab",t.style.cssText="\n                background-color: var(--neutral-gray);\n            ",t.addEventListener("click",(()=>r(t))),t}}preserveCellContent=()=>{table.querySelectorAll("tbody tr").forEach((e=>{Array.from(e.querySelectorAll("td.dt-cell-td")).forEach(((e,t)=>{if(!e||t>=columnTypes.length)return;switch(columnTypes[t]){case ColumnTypes.CHECKBOX:const t=e.querySelector(".fa-regular.fa-square");if(t){t.querySelector(".fa-square-check");const e=t.cloneNode(!0);t.parentNode.replaceChild(e,t);const n=e.querySelector(".fa-square-check");e.addEventListener("click",(()=>{const e="none"===n.style.display;n.style.display=e?"block":"none"}))}break;case ColumnTypes.LINK:const n=e.querySelector("span");if(n){n.textContent;const e=n.cloneNode(!0);e.setAttribute("contenteditable","true"),n.parentNode.replaceChild(e,n)}break;case ColumnTypes.ACTION:const a=e.querySelector("i");if(a){a.className;const e=a.cloneNode(!0);a.parentNode.replaceChild(e,a),e.addEventListener("click",(t=>{t.preventDefault(),showIconPicker(e)}))}break;case ColumnTypes.TEXT:default:e.hasAttribute("contenteditable")||e.setAttribute("contenteditable","true")}}))}))};setupTable=e=>{if(!e)return console.error("No content provided to setupTable"),null;const t=e.querySelector(".data-table-scroll-wrapper");if(!t)return console.error("No table wrapper found in content"),null;const n=t.querySelector(".data-table-main");if(!n)return console.error("No table found in wrapper"),null;let a=e.querySelector(".data-table-button-container");if(!a){a=document.createElement("div"),a.className="data-table-button-container";const t=document.createElement("button");t.className="data-table-add-column-btn",t.innerHTML='<i class="fas fa-plus"></i><span>Column</span>';const n=document.createElement("button");n.className="data-table-add-row-btn",n.innerHTML='<i class="fas fa-plus"></i><span>Row</span>',a.appendChild(n),a.appendChild(t),e.appendChild(a)}const o={CHECKBOX:"checkbox",TEXT:"text",LINK:"link",ACTION:"action (icon)"},r={hasCheckboxColumn:!1,columns:[],rows:[],activeControls:null,isResizing:!1,currentResizer:null,startX:0,startWidth:0,initialRightEdge:0},s=(e=o.TEXT)=>{const t=document.createElement("td");switch(t.className="dt-cell-td",e){case o.CHECKBOX:const e=document.createElement("div");e.className="fa-regular fa-square",e.style.cssText="\n                    margin: -2px 10px 0 10px;\n                    border-radius: 4px;\n                    cursor: pointer;\n                    position: relative;\n                    font-size: 18px;\n                    color: #a0a0a0;\n                ";const n=document.createElement("i");n.className="fa-solid fa-square-check",n.style.cssText="\n                    font-size: 18px;\n                    color: var(--primary-color);\n                    display: none; \n                    position: absolute;\n                    top: 0px;\n                    left: 0px;\n                    border: none;\n                ",e.appendChild(n),e.addEventListener("click",(()=>{const e="none"===n.style.display;n.style.display=e?"block":"none"})),t.appendChild(e);break;case o.LINK:const a=document.createElement("span");a.textContent="Link Text",a.style.cssText="\n                    color: #0d87d8;\n                    cursor: pointer;\n                ",a.setAttribute("contenteditable","true"),t.appendChild(a);break;case o.ACTION:const r=document.createElement("i");r.className="fas fa-bolt",r.addEventListener("click",(e=>{e.preventDefault(),showIconPicker(r)}));const s=document.createElement("span");s.setAttribute("contenteditable","true"),s.style.cssText="\n                    margin-left: 8px;\n                ",s.textContent="Action",t.classList.add("icon-container"),t.appendChild(r),t.appendChild(s);break;default:t.setAttribute("contenteditable","true"),t.textContent="Cell Text"}return t};let l=n.querySelector("thead tr");if(!l){if(!n.querySelector("thead")){const e=document.createElement("thead");n.appendChild(e)}l=document.createElement("tr"),n.querySelector("thead").appendChild(l)}if(l)try{l._sortable&&l._sortable.destroy(),new Sortable(l,{animation:150,handle:".data-table-header-cell",filter:".td-column-resizer-line",preventOnFilter:!0,ghostClass:"sortable-ghost",onEnd:function(e){e.item.style.cursor="",n.querySelectorAll("td").forEach((e=>{e.style.backgroundColor="var(--input-bg-color)"}));const t=e.oldIndex,a=e.newIndex;if(t===a)return;Array.from(n.querySelectorAll("tbody tr")).forEach((e=>{const n=Array.from(e.children),[o]=n.splice(t,1);a>=n.length?e.appendChild(o):e.insertBefore(o,n[a])}))},onStart:function(e){if(r.isResizing)return e.preventDefault(),!1;e.item.style.cursor="grabbing";const t=e.oldIndex;n.querySelectorAll(`td:nth-child(${t+1})`).forEach((e=>{e.style.backgroundColor="rgba(37, 137, 203, 0.9)"}))},onMove:function(e){return!e.related.classList.contains("navbar-spacer")}})}catch(e){console.error("Error setting up Sortable for table header:",e)}const c=(e="New Column",t=o.TEXT)=>{const n=document.createElement("th");n.className="data-table-header-cell",n.addEventListener("mouseenter",(()=>{n.style.cursor="grab"})),n.addEventListener("mouseleave",(()=>{n.classList.contains("sortable-chosen")||(n.style.cursor="")}));const a=document.createElement("div");a.className="data-table-header-content";const s=document.createElement("span");s.textContent=e,s.setAttribute("contenteditable","true"),a.appendChild(s);const l=document.createElement("div");l.className="td-header-icon icon-container";const c=document.createElement("i");c.className="fas fa-sort",c.addEventListener("click",(e=>{e.preventDefault(),showIconPicker(c)})),l.appendChild(c),a.appendChild(l);const i=document.createElement("div");i.className="td-column-resizer";i.addEventListener("mousedown",(e=>{e.preventDefault(),e.stopPropagation(),r.isResizing=!0,r.currentResizer=i,r.startX=e.pageX,r.startWidth=n.offsetWidth;const t=n.getBoundingClientRect();r.initialRightEdge=t.right;const a=document.createElement("div");a.id="resize-overlay",document.body.appendChild(a);const o=document.createElement("div");o.className="td-column-resizer-line",o.style.left=`${t.right}px`,o.id="resize-line",document.body.appendChild(o)}));const u=document.createElement("div");u.className="data-table-column-controls";const m=document.createElement("select");m.className="dt-col-type-selector",Object.values(o).forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),m.appendChild(t)})),m.value=t,m.addEventListener("mousedown",(e=>{e.stopPropagation(),u.style.display="flex",r.activeControls=u})),m.addEventListener("change",(e=>{e.stopPropagation(),d(n,m.value),n.setAttribute("data-column-type",m.value),setTimeout((()=>{r.activeControls===u&&(u.style.display="none",r.activeControls=null)}),200)})),u.appendChild(m);const h=document.createElement("i");return h.className="fas fa-trash delete-dt-col-btn",h.setAttribute("title","delete column"),h.addEventListener("click",(()=>{const e=Array.from(n.parentElement.children).indexOf(n);p(e)})),u.appendChild(h),n.appendChild(a),n.appendChild(u),n.appendChild(i),n.addEventListener("mouseenter",(()=>{r.activeControls||r.isResizing||(u.style.display="flex")})),n.addEventListener("mouseleave",(e=>{u.contains(e.relatedTarget)||r.activeControls===u||(u.style.display="none")})),n},i=e=>{const t=document.createElement("tr");t.className="data-table-row";const n=e.children;Array.from(n).forEach((e=>{const n=e.querySelector("select")?.value||o.TEXT;t.appendChild(s(n))}));const a=document.createElement("i");return a.className="fas fa-trash row-controls",a.setAttribute("title","delete row"),a.addEventListener("click",(()=>{const e=t.closest("tbody");t.remove(),u(e)})),t.appendChild(a),t.addEventListener("mouseenter",(()=>{t.style.position="relative",a.style.display="flex"})),t.addEventListener("mouseleave",(()=>{t.style.position="initial",a.style.display="none"})),t},d=(e,t)=>{const a=Array.from(e.parentElement.children).indexOf(e);n.querySelectorAll("tbody tr").forEach((e=>{const n=e.children[a],o=s(t);e.replaceChild(o,n)})),e.setAttribute("data-column-type",t)},p=e=>{n.querySelectorAll("tr").forEach((t=>{t.children.length>e&&t.deleteCell(e)}))},u=e=>{const t=e.children.length;if(a){const e=a.querySelector(".data-table-add-row-btn");e&&(e.style.display=t>=20?"none":"flex")}};if(!n.querySelector("tbody")){const e=document.createElement("tbody");n.appendChild(e)}const m=a.querySelector(".data-table-add-column-btn");if(m){const e=m.cloneNode(!0);m.parentNode.replaceChild(e,m),e.addEventListener("click",(()=>{const e=n.querySelector("thead tr"),t=c("New Column",o.TEXT);t.setAttribute("data-column-type",o.TEXT),e.appendChild(t);n.querySelectorAll("tbody tr").forEach((e=>{const t=e.lastElementChild;t&&t.classList.contains("row-controls")?e.insertBefore(s(o.TEXT),t):e.appendChild(s(o.TEXT))}))}))}const h=a.querySelector(".data-table-add-row-btn");if(h){const e=h.cloneNode(!0);h.parentNode.replaceChild(e,h),e.addEventListener("click",(()=>{const e=n.querySelector("thead tr"),t=n.querySelector("tbody");e&&t&&(t.appendChild(i(e)),u(t))}))}document.addEventListener("mousemove",(e=>{if(r.isResizing){document.querySelectorAll(".td-column-resizer").forEach((e=>{e.style.background="transparent"}));const t=e.pageX-r.startX,n=Math.max(60,r.startWidth+t);r.currentResizer.parentElement.style.width=`${n}px`;const a=document.getElementById("resize-line");a&&(a.style.transform=`translateX(${t}px)`)}})),document.addEventListener("mouseup",(()=>{if(r.isResizing){r.isResizing=!1,r.currentResizer=null,r.startX=0,r.startWidth=0;const e=document.getElementById("resize-overlay"),t=document.getElementById("resize-line");e&&e.remove(),t&&t.remove()}})),document.addEventListener("click",(e=>{r.activeControls&&!r.activeControls.contains(e.target)&&(r.activeControls.style.display="none",r.activeControls=null)}));const y=()=>{a.style.display="flex"},v=e=>{const n=e.relatedTarget;t.contains(n)||a.contains(n)||(a.style.display="none")};if(t.addEventListener("mouseenter",y),t.addEventListener("mouseleave",v),a.addEventListener("mouseenter",y),a.addEventListener("mouseleave",v),0===l.children.length){[{text:"Check",type:o.CHECKBOX},{text:"ID",type:o.LINK},{text:"Name",type:o.TEXT},{text:"Action",type:o.ACTION}].forEach((({text:e,type:t})=>{const n=c(e,t);n.setAttribute("data-column-type",t),l.appendChild(n)}));const e=n.querySelector("tbody");if(e)for(let t=0;t<3;t++)e.appendChild(i(l))}return{createRow:i,createHeaderCell:c,updateColumnType:d,deleteColumn:p}};wrapComponentInContainer(e,t,n=!1){const a=document.createElement("div");a.className="component-container",a.setAttribute("data-component-type",t);const o=document.createElement("div");o.className="selected-overlay",a.appendChild(o);const r=document.createElement("div");r.className="component-handle",r.textContent="⋮";const s=document.createElement("button");s.className="delete-btn",s.textContent="×";const l=document.createElement("button");l.className="duplicate-btn",l.setAttribute("title","clone"),l.innerHTML='<i class="fa-solid fa-clone"></i>';const c=document.createElement("div");if(c.className="component-content",c.addEventListener("mouseleave",(()=>{c.style.outline="none"})),e.closest(".component-container")){const t=e.querySelector(".component-content")?.firstElementChild;t&&c.appendChild(t.cloneNode(!0))}else e.container&&"function"==typeof e.setup?(c.appendChild(e.container),e.setup()):c.appendChild(e);if(a.append(r,s,l,c),this.setupComponentHandlers(this,a,t),this.setupImageUpload(c),this.setupIconPicker(c),this.setupInputListeners(c,t),this.setupVariantControls(a,c,t),this.setupResize(a),!n&&c.querySelector('[style*="var(--color"]')){c.querySelectorAll('[style*="var(--color"]').forEach((e=>{if(e.closest(".component-container")===a){const t=createColorSwatches(e);Array.isArray(t)?t.forEach((e=>{e&&e.children.length>0&&a.insertBefore(e,a.firstChild)})):t&&t.children.length>0&&a.insertBefore(t,a.firstChild)}}))}return a.querySelectorAll(".resizeable").forEach((e=>resizer.makeResizable(e))),a}setupProgressBar(e,t=76){t=Math.min(100,Math.max(0,Math.round(t)));const n=e.querySelector(".progress-bar"),a=n.querySelector("svg"),o=n.querySelector('svg path[fill="var(--color-primary)"]'),r=n.querySelectorAll("path[stroke-dasharray]"),s=n.querySelector("div > div"),l=e.querySelector('[contenteditable="true"]');function c(e){if(o){const t=e/100*2*Math.PI,n=Math.cos(t),a=Math.sin(t),r=`M 0 0 L 1 0 A 1 1 0 ${e>50?1:0} 1 ${n} ${a} L 0 0`;o.setAttribute("d",r)}else r.length?r.forEach((t=>{t.setAttribute("stroke-dasharray",`${e}, 100`)})):s&&(s.style.width=e+"%");l.textContent=e+"%"}n&&(o||r.length||s)&&l&&(c(t),n.addEventListener("click",(e=>{if(e.target===l||l.contains(e.target))return;const t=n.getBoundingClientRect();if(a){const n=t.left+t.width/2,a=t.top+t.height/2;let o=Math.atan2(e.clientY-a,e.clientX-n);o+=Math.PI/2,o<0&&(o+=2*Math.PI);let r=o/(2*Math.PI)*100;c(Math.round(r))}else{const n=e.clientX-t.left,a=t.width;c(Math.round(n/a*100))}})),l.addEventListener("input",(()=>{let e=l.textContent;e=e.replace(/[^\d%]/g,""),e=e.replace(/%/g,"")+"%";let t=parseInt(e);isNaN(t)||(t=Math.min(100,Math.max(0,t)),c(t))})),l.addEventListener("blur",(()=>{let e=parseInt(l.textContent);isNaN(e)&&(e=0),e=Math.min(100,Math.max(0,e)),c(e)})),l.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),l.blur())})))}setupDeleteHandler(e){const t=e.querySelector(".delete-btn");t&&t.addEventListener("click",(()=>{e.classList.add("delete-animation"),setTimeout((()=>{e.remove()}),200)}))}setupComponentHandlers(e,t,n){const a=[];switch(this.setupDeleteHandler(t),this.setupDuplicateHandler(e,t,n),n){case"adjustableSpace":this.setupAdjustableSpace(t);break;case"progressBar":this.setupProgressBar(t)}t._cleanup=()=>a.forEach((e=>e()))}setupIconPicker=e=>{e.querySelectorAll(".icon-container i").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),showIconPicker(e)}))}))};setupAdjustableSpace(e){const t=e.closest(".component-container");t&&(t.addEventListener("mouseenter",(()=>{e.style.outline="1px dashed var(--neutral-gray)"})),t.addEventListener("mouseleave",(()=>{e.style.outline="none"})))}setupResize(e){const t=e.querySelector("[data-placeholder]"),n=e.querySelector(".resize-handle");if(!n||!t)return;let a,o;function r(e){const n=o+(e.clientY-a);n>=80&&(t.style.height=`${n}px`)}function s(){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)}n.addEventListener("mousedown",(e=>{a=e.clientY,o=parseInt(window.getComputedStyle(t).height),document.addEventListener("mousemove",r),document.addEventListener("mouseup",s),e.preventDefault()}))}setupImageUpload(e){e.querySelectorAll(".card-image, .nav-image, .hero .card-image").forEach((t=>{const n=null!==t.closest(".hero");async function a(e){const t=e.target?.files?.[0]||e.dataTransfer?.files?.[0];if(!t||!t.type.startsWith("image/"))return;const n=new FileReader;n.onload=async e=>{o(e.target.result);try{const e=firebase.auth().currentUser;if(!e)return;const n=await firebase.firestore().collection("users").doc(e.uid).get();if(n.exists&&n.data().pro_account){const n=new ProImageStorageManager,a=projectManager.currentProject?.id;if(a){o((await n.handleImageUpload(t,a,e.uid)).url)}}}catch(e){console.error("Error handling pro image upload:",e)}},n.readAsDataURL(t)}function o(a){n?(t.style.backgroundImage=`url(${a})`,t.style.backgroundSize="cover",t.style.backgroundPosition="center",t.style.backgroundColor="transparent",t.classList.add("with-image"),t.textContent=""):(t.style.backgroundImage=`url(${a})`,t.style.position="relative",t.style.backgroundSize="cover",t.style.backgroundPosition="center",t.style.backgroundColor="transparent",t.classList.add("with-image"),t.innerHTML="");const o=e.querySelectorAll(".resizeable");o.length&&o.forEach((e=>{resizer.makeResizable(e)}))}t.addEventListener("click",(()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=a,e.click()})),["dragenter","dragover","dragleave","drop"].forEach((e=>{t.addEventListener(e,(e=>{e.dataTransfer&&e.dataTransfer.types.includes("Files")&&(e.preventDefault(),e.stopPropagation())}))})),t.addEventListener("dragenter",(e=>{if(e.dataTransfer&&e.dataTransfer.types.includes("Files")){const n=e.dataTransfer.items;Array.from(n).some((e=>"file"===e.kind&&e.type.startsWith("image/")))&&(t.style.outline="2px dashed var(--color-primary)",t.style.outlineOffset="-8px",t.style.backgroundColor="rgba(52, 152, 219, 0.1)")}})),t.addEventListener("dragleave",(()=>{t.style.outline="none",t.style.outlineOffset="0",t.style.backgroundColor="var(--neutral-gray)"})),t.addEventListener("drop",(function(e){if(function(e){e.preventDefault(),e.stopPropagation()}(e),t.style.outline="none",t.style.outlineOffset="0",t.style.backgroundColor="var(--neutral-gray)",e.dataTransfer.types.includes("Files")){const t=e.dataTransfer.items;Array.from(t).some((e=>"file"===e.kind&&e.type.startsWith("image/")))&&a(e)}}))}))}setupDuplicateHandler(e,t,n){const a=t.querySelector(".duplicate-btn");a&&a.addEventListener("click",(()=>{e.duplicateComponent(t,n)}))}duplicateComponent(e,t){const n=e.querySelector(".component-content > *"),a=this.createDuplicate(n,t,!1);if(a){e.parentNode.insertBefore(a,e.nextSibling);const n=a.querySelector(".component-content > *");n.classList.add("duplicate-animation"),setTimeout((()=>{n.classList.remove("duplicate-animation")}),200);if(a.querySelectorAll(".resize-handle").forEach((e=>e.style.display="none")),"columns"===t){const e=a.querySelector(".columns-wrapper");console.log("Columns container for setup:",{columnsContainer:e,wrappedDuplicateChildren:Array.from(a.children).map((e=>e.className))});e.querySelector(".columns-controls").style.display="none",e?this.setupColumns(e):console.error("Could not find columns-wrapper in duplicate")}}}createDuplicate(e,t,n=!1){e._cleanup&&e._cleanup();const a=n?e.cloneNode(!0).firstElementChild:this.components[t]?.(e);if(!a)return null;const o="chipGroup"===t||"graph"===t;a.querySelectorAll(".variant-controls, .color-swatch-container, .delete-btn, .duplicate-btn, .component-handle, .alignment-arrow").forEach((e=>e.remove()));const r=this.wrapComponentInContainer(a,t,o),s=r.querySelector(".component-content > *");this.copyUserModifications(e,s),"columns"===t&&this.setupColumns(r.querySelector(".columns-wrapper"));const l=r.querySelector(".align-content");if(l&&["avatar","icon"].includes(t)){const t=e.querySelector(".align-content"),n=t?.style.justifyContent||"center",a=createAlignmentControls(l);a.setAlignment(n),a.hideArrows()}if(s.querySelectorAll('[contenteditable="true"]').forEach((e=>{e.addEventListener("keypress",(e=>{"Enter"===e.key&&e.preventDefault()})),e.addEventListener("paste",(e=>{e.preventDefault();const t=(e.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,t)}))})),this.components[t]?.setup){this.components[t].setup(s);const n=e.querySelector(".component-content");this.setupVariantControls(e,n,t),this.setupComponentHandlers(this,n,t),this.showIconPicker(s)}const c={progressTracker:()=>this.setupProgressTracker(r),imgGallery:()=>setupImageGallery(r),chipGroup:()=>{this.setupChipGroup(r),createGroupColorSwatch(r)},tabs:()=>this.setupTabs(r),notificationBanner:()=>this.setupNotificationBanner(r),progressBar:()=>this.setupProgressBar(r),blankCard:()=>this.setupBlankCard(r),checkbox:()=>this.setupCheckboxes(r),radio:()=>this.setupRadios(r),graph:()=>{createGraphColorSwatch(r)},hzDivider:()=>this.setupDividerState(r),icon:()=>this.copyIconState(e,r),adjustableSpace:()=>this.copyAdjustableSpaceState(e,r),accordion:()=>{const e=r.querySelector(".accordion-content");e&&requestAnimationFrame((()=>{this.setupAccordionContent(e)}))}};return c[t]&&c[t](),r}specializedSetups2={bulletedList:e=>this.setupBulletedList(e)};copyUserModifications(e,t){const n=Array.from(e.querySelectorAll("[data-component-type]")),a=Array.from(t.querySelectorAll("[data-component-type]"));n.forEach(((e,t)=>{const n=e.dataset.componentType,o=a[t];if(o){const t=this.createDuplicate(e,n);o.replaceWith(t),t.closest(".component-content")&&this.specializedSetups2[n]&&this.specializedSetups2[n](t)}}))}copyAdjustableSpaceState(e,t){const n=t.querySelector(".space-range"),a=t.querySelector(".height-display"),o=e.offsetHeight;n.value=o,a.value=o,n&&a&&(n.addEventListener("input",(()=>{const e=n.value;t.style.height=`${e}px`,a.value=e})),a.addEventListener("change",(()=>{const e=a.value;t.style.height=`${e}px`,n.value=e})))}copyIconState(e,t){const n=t.querySelector("i:not(.iconControls)"),a=t.querySelector("input.iconControls");if(!n)return void console.error("iconElement not found or not in the DOM");let o=getComputedStyle(n).fontSize||n.style.fontSize;const r=parseInt(o,10)||24;a.value=r;const s=a._resizeListener;s&&a.removeEventListener("input",s);const l=e=>{n.style.fontSize=`${e.target.value}px`};a._resizeListener=l,a.addEventListener("input",l),n.addEventListener("click",(e=>{e.preventDefault(),showIconPicker(n)})),n.setAttribute("data-listeners-attached","true")}setupColumns(e){if(!e)return void console.error("Attempted to setup columns with null container");if(e._isSetup)return;e._isSetup=!0;const t=e.querySelector(".columns-controls"),n=t.querySelector('input[type="range"]'),a=t.querySelector("button:first-child"),o=t.querySelector("button:nth-child(3)"),r=t.querySelector("span:nth-child(2)"),s=t.querySelector("span:last-child"),l=e.closest(".component-container");l&&l.querySelectorAll(":scope > .color-swatch-container").forEach((e=>{e.remove()}));const c=()=>{const e=document.createElement("div");e.className="column-container pulseAnim",e.style.cssText="\n                min-height: 38px;\n                max-height: 2000px;\n                border-radius: 4px;\n                transition: outline 0.2s;\n                padding: 2px;\n                min-width: min-content;\n                position: relative;\n                gap: 4px;\n            ";const t=document.createElement("div");return t.classList.add("empty-placeholder"),t.innerHTML='<i class="fas fa-table-columns"></i>',e.appendChild(t),this.initializeSortable(e),e},i=t=>{const n=e.querySelectorAll(".column-container"),s=n.length;if(t!==s){if(e.style.gridTemplateColumns=`repeat(${t}, minmax(90px, 1fr))`,r.textContent=t,t>s)for(let n=s;n<t;n++){const t=c();e.appendChild(t)}else{const e=n[0];for(let a=s-1;a>=t;a--){const t=n[a];for(;t.firstChild;)e.appendChild(t.firstChild);t.remove()}}a.style.opacity=t<=1?"0.5":"1",a.style.cursor=t<=1?"default":"pointer",o.style.opacity=t>=6?"0.5":"1",o.style.cursor=t>=6?"default":"pointer"}};n.addEventListener("input",(t=>{const n=t.target.value;s.textContent=n,e.style.gap=`${n}px`})),a.addEventListener("click",(()=>{const e=parseInt(r.textContent);e>1&&i(e-1)})),o.addEventListener("click",(()=>{const e=parseInt(r.textContent);e<6&&i(e+1)})),e.addEventListener("mouseenter",(()=>{t.style.display="flex"})),e.addEventListener("mouseleave",(()=>{t.style.display="none"}));new MutationObserver((()=>{const t=e.querySelectorAll(".column-container");let n=50;t.forEach((e=>{const t=e.cloneNode(!0);t.style.position="absolute",t.style.visibility="hidden",t.style.width="min-content",document.body.appendChild(t);const a=t.offsetWidth;n=Math.max(n,a),document.body.removeChild(t)})),e.style.gridTemplateColumns=`repeat(auto-fit, minmax(${n}px, 1fr))`,t.forEach((e=>{const t=e.querySelector(":scope > .empty-placeholder"),n=e.querySelector(".component-container");if(t){e.querySelector(":scope > .component-container");t.style.display=n?"none":"block"}}))})).observe(e,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),0===e.querySelectorAll(".column-container").length&&i(2),e.querySelectorAll(".column-container").forEach((e=>{this.initializeSortable(e,{group:{name:"shared-components",pull:!0,put:function(e,t,n){return!n.classList.contains("columns-wrapper")}},filter:".columns-wrapper",onMove:function(e){return!e.dragged.classList.contains("columns-wrapper")||!e.to.closest(".column-container")}})}))}setupDividerState(e){const t=e.querySelector(".divider-line"),n=e.querySelector('input[type="range"]'),a=e.querySelectorAll(".hzRuleControls i");t&&n&&a&&(n.addEventListener("input",(e=>{t.style.borderWidth=`${e.target.value}px 0 0 0`})),a.forEach((e=>{e.addEventListener("click",(()=>{const a=e.title.toLowerCase(),o=n.value;t.style.borderStyle="dotted"===a?"dotted":"double"===a?"double":"solid",t.style.borderWidth=`${o}px 0 0 0`}))})))}copyDividerState(e,t){this.setupDividerState(t)}setupCheckboxes(e){const t=e.querySelector(".checkbox-square-icon"),n=t?.querySelector(".checkbox-check-icon"),a=e.querySelector("span");t&&(t.removeEventListener("click",this._checkboxClickHandler),this._checkboxClickHandler=()=>{n&&n.classList.toggle("checked")},t.addEventListener("click",this._checkboxClickHandler)),a&&this.makeTextEditable(a)}setupDropdown(e){const t=e.querySelector(".dropdown-header"),n=e.querySelector(".selected-text"),a=e.querySelector(".fa-chevron-down, .fa-chevron-up"),o=e.querySelector(".options-container"),r=e.querySelector(".add-option-wrapper"),s=r.querySelector(".add-button");t.addEventListener("click",(()=>{o.classList.toggle("active"),a.classList.toggle("fa-chevron-up"),a.classList.toggle("fa-chevron-down")})),s.addEventListener("click",(()=>{const e=document.createElement("div");e.className="option-wrapper";const t=document.createElement("div");t.className="option",t.setAttribute("contenteditable","true"),t.textContent="New Option";const n=document.createElement("button");n.className="delete-button",n.innerHTML='<i class="fas fa-times"></i>',e.appendChild(t),e.appendChild(n),o.insertBefore(e,r),t.focus(),n.addEventListener("click",(t=>{t.stopPropagation(),e.remove()}))})),o.addEventListener("click",(e=>{const t=e.target.closest(".option");t&&(n.textContent=t.textContent)}))}setupRadios(e){let t=e.querySelector(".custom-radio"),n=t.querySelector("span"),a=e.querySelector("span:not(.radio-dot)");t.addEventListener("click",(()=>{document.querySelectorAll(".custom-radio").forEach((e=>{e.querySelector("span").style.display="none",e.style.borderColor="#e0e0e0"})),n.style.display="block",t.style.borderColor="var(--color-primary)"})),a&&(this.makeTextEditable(a),a.addEventListener("click",(e=>{e.stopPropagation()})))}removeComponent(e,t){t.forEach((t=>{const n=t.querySelector(".canvas-content");switch(e){case"navbar":const e=t.querySelector(".navContain");if(e){e.remove();let t=n.querySelector(".navbar-spacer");t&&t.remove(),n.style.paddingTop="30px",this.topNavbarAdded=!1}break;case"bottomNav":const a=t.querySelector(".bottomNavContain");a&&(a.remove(),this.bottomNavbarAdded=!1);break;case"sidebar":const o=t.querySelector(".sidebar-container");o&&(o.remove(),this.sidebarAdded=!1);break;case"modal":const r=t.querySelector(".modal-wrapper");r&&(r.remove(),this.modalAdded=!1);break;case"floatingActionButton":const s=t.querySelector(".fab-container");s&&(s.remove(),this.fabAdded=!1)}}))}resetCanvasCount(){this.state.canvasCount=0}async createNewCanvas(){if(!firebase.auth().currentUser&&this.state.canvasCount>=2)return void showAuthModal("Log In or Sign Up to create more screens","Logged-in designers save projects and add more screens for free!");if(firebase.auth().currentUser&&this.state.canvasCount>=3){const e=async e=>{try{const t=await firebase.firestore().collection("users").doc(e.uid).get();return t.data()?.pro_account||!1}catch(e){return console.error("Error checking subscription status:",e),!1}};if(!await e(firebase.auth().currentUser))return void projectManager.showSubscriptionModal("Upgrade to Create Unlimited Screens","You've reached the limit for free screens.")}this.state.canvasCount++;const e=document.createElement("div");e.className="canvas-wrapper animate-in";const t=`canvas-${this.state.canvasCount}`,n=new Date,a=n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0");e.innerHTML=`\n        <div class="canvas-number-container">\n            <div class="dimension-indicator">\n                <div>\n                    <i class="fa-solid fa-mobile-screen"></i>\n                    <span class="dimensions"></span>\n                </div>\n            </div>\n            <div class="spaceHolder"></div>\n            <div class="canvas-number" >Screen ${this.state.canvasCount}</div>\n            <div>\n                <button class="delete-canvas-btn">×</button>\n            </div>\n        </div>\n\n        <div class="canvas" id="${t}">\n\n            <div class="status-bar">\n                <div class="mobile-status">\n                    <span class="time">${a}</span>\n                    <div class="camera"></div>\n                    <div class="iphone-notch" style="display: none"></div>\n                    <div class="dynamic-island" style="display: none"></div>\n                    <div class="icons">\n                        <div class="icon-container">\n                        <i class="fa-solid fa-signal"></i>\n                        </div>\n                        <div class="icon-container">\n                        <i class="fa-solid fa-wifi"></i>\n                        </div>\n                        <div class="icon-container">\n                        <i style="font-size: 14px;" class="fa-solid fa-battery-full"></i>\n                        </div>\n                    </div>\n                    <div class="status-overlay" style="width: 100%; height: 28px; background-color: rgba(51, 51, 51, 0.48); z-index: -1; position: absolute; top: 0; left: 0;"></div>\n                </div>\n        \n                <div class="desktop-status" style="display: none">\n                    <div class="browser-actions">\n                        <span class="browser-dot"></span>\n                        <span class="browser-dot"></span>\n                        <span class="browser-dot"></span>\n                    </div>\n                    <div class="browser-address" contenteditable>\n                        <i class="fa-solid fa-lock"></i>\n                        <span>dlightning.org</span>\n                    </div>\n                    <div class="icon-container" style="display: flex; gap: 8; margin-right: 28px;">\n                    <i class="fa-solid fa-circle-user"></i>\n                    </div>\n                    <div style="width: 100%; height: 28px; background-color: rgba(51, 51, 51, 0.48); z-index: -1; position: absolute; top: 0; left: 0;"></div>\n                </div>\n                \n            </div>\n\n            <div class="phoneScrollCon">\n                <div class="canvas-content"></div>\n            </div>\n        </div>\n        \n    `;const o=e.querySelector(".canvas"),r=e.querySelector(".dimensions"),s=e.querySelector(".dimension-indicator i"),l=()=>{const{offsetWidth:t,offsetHeight:n}=o,a=o.querySelector(".status-bar"),l=a.querySelector(".mobile-status"),c=a.querySelector(".status-overlay"),i=a.querySelector(".desktop-status"),d=a.querySelector(".iphone-notch"),p=a.querySelector(".dynamic-island"),u=a.querySelector(".camera"),m=e.querySelector(".canvas-content");if(!r.matches(":focus")){r.textContent=`${t-6} × ${n-6}`;const e=o.closest(".canvas-wrapper");if(e){const a=e.getAttribute("data-canvas-id");a&&projectManager&&"function"==typeof projectManager.addCanvasToChanged&&(projectManager.addCanvasToChanged(a,`Dimensions changed to ${t}x${n}`),projectManager.contentChanged=!0)}}t<480?(s.className="fa-solid fa-mobile-screen",l.style.backgroundColor="var(--color-primary)",c.style.backgroundColor="rgba(51, 51, 51, 0.48)",p.style.display="none",d.style.display="none",m.style.paddingTop="26px",m.style.minHeight="calc(100% - 100px)",u.style.display="block",396===t&&850===n?p.style.display="block":(381===t&&673===n||420===t&&902===n||434===t&&932===n)&&(d.style.display="block")):t<1024?(s.className="fa-solid fa-tablet-screen-button",l.style.backgroundColor="transparent",c.style.backgroundColor="rgba(31, 31, 31, 0.28)",l.style.display="flex",i.style.display="none",p.style.display="none",d.style.display="none",m.style.paddingTop="0px",m.style.minHeight="calc(100%)",m.firstChild.style.marginTop="-2px",u&&(u.style.display="none")):(s.className="fa-solid fa-desktop",l.style.display="none",i.style.display="flex",p.style.display="none",d.style.display="none",m.style.paddingTop="26px",m.style.minHeight="calc(100% - 100px)",u&&(u.style.display="none"))};r.contentEditable=!0,r.spellcheck=!1;r.addEventListener("focus",(()=>{r.dataset.original=r.textContent})),r.addEventListener("blur",(()=>{const e=(e=>{const t=e.match(/(\d+)\s*×\s*(\d+)/);return t?{width:parseInt(t[1],10),height:parseInt(t[2],10)}:null})(r.textContent);if(e){const t=Math.max(160,e.width),n=Math.max(142,e.height);o.style.width=`${t}px`,o.style.height=`${n}px`,r.textContent=`${t} × ${n}`}else r.textContent=r.dataset.original})),r.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),r.blur()),"Escape"===e.key&&(e.preventDefault(),r.textContent=r.dataset.original,r.blur())})),r.addEventListener("mousedown",(e=>{e.target===r&&e.stopPropagation()}));new ResizeObserver(l).observe(o),l();const c=e.querySelector(".dimension-indicator i"),i=this.createScreenSizeModal();c.addEventListener("click",(e=>{e.stopPropagation(),i.style.display="flex";i.querySelectorAll(".screen-size-option").forEach((e=>{e.onclick=()=>{const t=parseInt(e.dataset.width),n=parseInt(e.dataset.height);o.style.width=`${t}px`,o.style.height=`${n}px`,o.style.transition="height 200ms, width 200ms";const a=t-6,l=n-6;r.textContent=`${a} × ${l}`,s.className=t<480?"fa-solid fa-mobile-screen":t<1024?"fa-solid fa-tablet-screen-button":"fa-solid fa-desktop",i.style.display="none",setTimeout((()=>{o.style.transition="none"}),200)}}))}));const d=document.querySelector(".add-screen-btn-con");d&&d.parentElement?d.parentElement.insertBefore(e,d):document.querySelector(".canvas-container").appendChild(e);const p=e.querySelector(".canvas");p.addEventListener("click",(e=>this.handleCanvasSelection(e)));const u=p.querySelector(".canvas-content");u&&this.initializeSortable(u),this.updateCanvasNumbers()}createScreenSizeModal(){const e=document.createElement("div");e.className="screen-size-modal",e.style.display="none";e.innerHTML=`\n        <div class="screen-size-modal-content">\n            <div class="screen-size-modal-header">\n                <h3>Standard Screen Sizes</h3>\n                <button class="screen-size-modal-close">×</button>\n            </div>\n            <div class="screen-size-modal-body">\n                ${[{name:"Galaxy Z Flip",width:320,height:746,icon:"mobile-screen"},{name:"Android Small",width:360,height:640,icon:"mobile-screen"},{name:"Pixel 4",width:360,height:740,icon:"mobile-screen"},{name:"Android Average",width:360,height:800,icon:"mobile-screen"},{name:"iPhone SE",width:375,height:667,icon:"mobile-screen"},{name:"Pixel 3",width:380,height:780,icon:"mobile-screen"},{name:"iPhone 12/13/14",width:390,height:844,icon:"mobile-screen"},{name:"Pixel 6",width:412,height:915,icon:"mobile-screen"},{name:"iPhone XR/11",width:414,height:896,icon:"mobile-screen"},{name:"Pixel 7",width:420,height:933,icon:"mobile-screen"},{name:"iPhone 12/13/14 Pro Max",width:428,height:926,icon:"mobile-screen"},{name:"Galaxy Z Fold",width:468,height:832,icon:"mobile-screen"},{name:"Galaxy Tab S7",width:712,height:1138,icon:"tablet-screen-button"},{name:"iPad Mini",width:768,height:1024,icon:"tablet-screen-button"},{name:"Galaxy Tab S8",width:800,height:1280,icon:"tablet-screen-button"},{name:"iPad Air",width:820,height:1180,icon:"tablet-screen-button"},{name:'iPad Pro 11"',width:834,height:1194,icon:"tablet-screen-button"},{name:"Galaxy Tab S8+",width:880,height:1440,icon:"tablet-screen-button"},{name:'iPad Pro 12.9"',width:1024,height:1366,icon:"tablet-screen-button"},{name:"Small Desktop",width:1280,height:720,icon:"desktop"},{name:"HD Desktop",width:1366,height:768,icon:"desktop"},{name:"Full HD",width:1920,height:1080,icon:"desktop"}].map((e=>`\n                    <div class="screen-size-option" data-width="${e.width}" data-height="${e.height}">\n                        <i class="fa-solid fa-${e.icon}"></i>\n                        <div class="screen-size-info">\n                            <div class="screen-size-name">${e.name}</div>\n                            <div class="screen-size-dimensions">${e.width} × ${e.height}</div>\n                        </div>\n                    </div>\n                `)).join("")}\n            </div>\n        </div>\n    `,document.body.appendChild(e),e.addEventListener("click",(t=>{t.target===e&&(e.style.display="none")}));return e.querySelector(".screen-size-modal-close").addEventListener("click",(()=>{e.style.display="none"})),e}async handleCanvasDelete(e){const t=e.target.closest(".canvas-wrapper");if(!t)return;const n=t.querySelector(".canvas"),a=Array.from(document.querySelectorAll(".canvas-wrapper")).indexOf(t)+1;if(await showConfirmDialog("Are you sure you want to delete this screen?",{heading:"Delete Current Screen",confirmText:"Delete",cancelText:"Nevermind"})){if(this.state.canvasCount--,this.state.selectedCanvases.has(n)){this.state.selectedCanvases.delete(n);const e=t.previousElementSibling?.querySelector(".canvas");e&&this.handleSingleSelect(e)}t.classList.add("delete-animation"),setTimeout((()=>{t.remove(),this.updateCanvasNumbers(),projectManager.currentProject?.id&&projectManager.handleCanvasDelete(a)}),200)}}makeTextEditable(e){e.addEventListener("click",(function(){if(e.querySelector("input"))return;const t=this.textContent,n=document.createElement("input");n.value=t,n.style.width="100%",n.style.boxSizing="border-box",n.style.font=window.getComputedStyle(this).font,e.dataset.originalText=t,this.textContent="",this.appendChild(n),n.focus(),n.select(),n.addEventListener("blur",(function(){const t=this.value||e.dataset.originalText;this.remove(),e.textContent=t})),n.addEventListener("keypress",(function(e){"Enter"===e.key&&this.blur()}))}))}insertNavbar(e,t,n){if(!(e.classList.contains("canvas")?e:e.querySelector(".canvas")))return void console.error("No canvas element found in insertNavbar");const a=e.querySelector(".canvas-content");if("top"===n){e.insertBefore(t,e.firstChild);let n=a.querySelector(".navbar-spacer");n||(n=document.createElement("div"),n.className="navbar-spacer",n.style.height="46px",n.style.width="100%",a.insertBefore(n,a.firstChild)),t.style.cssText="position: absolute; left: 0; right: 0; top: 28px;"}else"bottom"===n?(e.appendChild(t),t.style.cssText="position: absolute; left: 0; right: 0; bottom: 0;"):"left"===n?(e.appendChild(t),t.style.cssText="position: absolute; left: 0; top:0; bottom: 0; height:100%;"):e.appendChild(t)}handleCanvasSelection(e){const t=e.currentTarget;e.shiftKey?this.handleMultiSelect(t):this.handleSingleSelect(t),this.updateCanvasNumbers(),this.updateGapControls()}handleMultiSelect(e){this.state.selectedCanvases.has(e)?this.state.selectedCanvases.size>1&&(this.state.selectedCanvases.delete(e),e.classList.remove("selected")):(this.state.selectedCanvases.add(e),e.classList.add("selected"))}handleSingleSelect(e){this.state.selectedCanvases.forEach((e=>{e.classList.remove("selected")})),this.state.selectedCanvases.clear(),this.state.selectedCanvases.add(e),e.classList.add("selected")}updateGapControls(){const e=Array.from(this.state.selectedCanvases)[0];if(e){const t=e.querySelector(".canvas-content");if(t){const e=t.style.gap,n=parseInt(e)||0,a=document.querySelector('.gap-range[type="range"]'),o=document.querySelector('.gap-range[type="number"]');a&&o&&(a.value=n,o.value=n)}}}updateCanvasNumbers(){document.querySelectorAll(".canvas-number").forEach(((e,t)=>{const n=e.closest(".canvas-wrapper").querySelector(".canvas"),a=this.state.selectedCanvases.has(n);e.textContent=`Screen ${t+1}${a?" (Selected)":""}`}))}replaceRangeSliders(e){e.querySelectorAll(".custom-range-slider").forEach((e=>{const t=document.createElement("div");t.style.cssText="\n            width: 100%;\n            height: 8px;\n            border-radius: 4px;\n            background: var(--neutral-gray);\n            position: relative;\n            padding: 0 4px;\n        ";const n=document.createElement("div"),a=(e.value-e.min)/(e.max-e.min)*100;n.style.cssText=`\n            position: absolute;\n            left: 4px;\n            top: 28%;\n            height: 40%;\n            width: ${a}%;\n            background: var(--color-primary);\n            border-radius: 4px;\n        `;const o=document.createElement("div");o.style.cssText=`\n            position: absolute;\n            left: calc(${a}% - 10px);\n            top: 50%;\n            transform: translateY(-50%);\n            width: 20px;\n            height: 20px;\n            border-radius: 50%;\n            background: var(--color-primary);\n        `,t.appendChild(n),t.appendChild(o),e.parentNode.replaceChild(t,e)}))}updateButtonState(e){const t=document.getElementById("download-btn");t&&(e?(t.innerHTML='<i class="fas fa-spinner fa-spin"></i> Generating...',t.disabled=!0,t.classList.add("loading")):(t.innerHTML='<i class="fas fa-download"></i> Download PNG',t.disabled=!1,t.classList.remove("loading")))}async captureScreenshot(){this.animationController.disableAnimations(),this.updateButtonState(!0);const e=scale;setZoomScale(1);try{const e=Array.from(this.state.selectedCanvases).map((async(e,t)=>{const n=e.querySelector(".phoneScrollCon");if(!n)return void console.error("Phone scroll container not found");const a=n.scrollTop,o=n.scrollLeft,r=e.cloneNode(!0),s=document.createDocumentFragment(),l=document.createElement("div");l.style.cssText=`\n          position: absolute;\n          top: -9999px;\n          left: -9999px;\n          width: ${e.clientWidth+12}px;\n          height: ${e.clientHeight+12}px;\n          overflow: hidden;\n          padding: 6px;\n        `,l.appendChild(r),s.appendChild(l),document.body.appendChild(s);const c=r.querySelector(".phoneScrollCon");if(c){c.scrollTop=0,c.scrollLeft=0;const e=c.firstElementChild;e&&(e.style.transform=`translate(${-o}px, ${-a}px)`)}Object.assign(r.style,{height:`${e.clientHeight}px`,width:`${e.clientWidth}px`,overflow:"hidden",margin:"0"}),this.replaceRangeSliders(r),await new Promise((e=>requestAnimationFrame(e)));const i=await html2canvas(r,{backgroundColor:null,logging:!1,useCORS:!0,scale:window.devicePixelRatio,width:e.clientWidth+12,height:e.clientHeight+12,scrollX:-6,scrollY:-6,windowWidth:e.clientWidth+12,windowHeight:e.clientHeight+12,imageTimeout:6e4,onclone:e=>new Promise((t=>{requestAnimationFrame((()=>{const n=e.querySelector(r.tagName);if(n){const e=n.querySelector(".phoneScrollCon");if(e){e.scrollTop=0,e.scrollLeft=0;const t=e.firstElementChild;t&&(t.style.transform=`translate(${-o}px, ${-a}px)`)}}t()}))}))});if(document.body.removeChild(l),0===i.width||0===i.height)return void console.error("Rendered screen has zero dimensions");const d=document.createElement("a"),p=this.state.selectedCanvases.size>1?`Dlightning-mockup-${t+1}.png`:"Dlightning-mockup.png";d.download=p,d.href=i.toDataURL("image/png",1),d.click()}));await Promise.all(e)}catch(e){console.error("Screenshot error:",e)}finally{this.animationController.restoreAnimations(),setZoomScale(e),this.updateButtonState(!1)}}setupDownloadButton(){document.getElementById("download-btn").addEventListener("click",(()=>this.captureScreenshot()))}initOnboarding(){if(localStorage.getItem("onboardingComplete"))return;if(window.innerWidth<=768||"ontouchstart"in window||navigator.maxTouchPoints>0)return;const e=document.createElement("div");e.className="onboarding-overlay";const t=document.createElement("div");t.className="onboarding-modal";const n=[{title:'Welcome to the <span style="letter-spacing: .2rem;;">Dlightning <i style="color: var(--color-accent)" class="fas fa-bolt-lightning"></i></span> <br> Screen Builder!',content:"Create beautiful wireframes<br> in minutes",gif:null,highlight:null},{title:"Add Components",content:"Select a component from the menu-bar to add it to&nbsp;the&nbsp;screen.<br><br>",gif:"img/gifs/add-comps.gif",highlight:".component-btn"},{title:"Component Peview",content:"Preview the component before you add it to the screen. Update the component's properties and drag it to the screen.",gif:"img/gifs/drag-preview.gif",highlight:".preview-trigger"},{title:"3 Menu Tabs",content:"Switch between common interface elements, pre-built components, and the overall theme!",gif:"img/gifs/sidebar-tabs.gif",highlight:".sidebar-tabs"},{title:"View Content Full-Height",content:"Toggle the mock screen's height to show all components.<br>Click this before export to download the screen at <i>full height</i>.",gif:"img/gifs/full-height.gif",highlight:"#toggleCanvasBtn"},{title:"Add A New Screen",content:"Create multiple screens using the + button.<br>Screens can be dragged and resized or deleted.",gif:"img/gifs/add-screen.gif",highlight:".add-canvas-btn"},{title:"Export Screens",content:"When you're ready to share your work, export an image. <br> <i>Use (shift + click) to select multiple screens at once</i>",gif:"img/gifs/export-screens.gif",highlight:"#download-btn"},{title:"Choose A Starting Template",content:" ",highlight:null,isTemplateStep:!0}];let a=localStorage.getItem("onboardingComplete")?n.length-1:0;function o(e){if(n[e].isTemplateStep?t.innerHTML=`\n                <h2 style="color: var(--basic-txt-color); margin-top: 0;">${n[e].title}</h2>\n                <p style="color: #475152; font-size: 16px;">${n[e].content}</p>\n                <div class="templates" style="display: flex; gap: 16px; margin: 20px 0;">\n                    <button onclick="selectTemplate('template1')">\n                        <h3 style="margin-top: 0;">Profile Template</h3>\n                        <hr>\n                        <p style="color: var(--basic-txt-color)">Image, Avatar, Pills, and Paragraph <br><br></p>\n                    </button>\n                    <button onclick="selectTemplate('template2')">\n                        <h3 style="margin-top: 0;">Content Template</h3>\n                        <hr>\n                        <p style="color: var(--basic-txt-color)">Hero, Heading, Accordion, and Footer</p>\n                    </button>\n                    <button onclick="selectTemplate('template3')">\n                        <h3 style="margin-top: 0;">Form Template</h3>\n                        <hr>\n                        <p style="color: var(--basic-txt-color)">Heading, Form Elements, Submit Button</p>\n                    </button>\n                    <button onclick="selectTemplate('blank')">\n                        <h3 style="margin-top: 0;">Blank Screen</h3>\n                        <br><br><br><br><br><br><br>\n                    </button>\n                </div>\n                <div class="onboarding-nav" >\n                    <button onclick="prevStep()" style="padding: 10px 14px; background: #ecf0f1; border: none; border-radius: 5px; cursor: pointer; margin-right: 45px;"><i class="fas fa-arrow-left"></i></button>\n                     <button onclick="${e===n.length-1?"completeOnboarding()":"nextStep()"}" style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">\n                            ${e===n.length-1?"Skip":"Next"}\n                        </button>\n                </div>\n            `:t.innerHTML=`\n                <div style="display: flex; gap: 24px;">\n                    <div>\n                    <h2 style="color: var(--basic-txt-color); margin-top: 0;">${n[e].title}</h2>\n                    <p style="color: #7f8c8d; font-size: 16px;">${n[e].content}</p>\n                    ${n[e].gif?`<img loading="lazy" src="${n[e].gif}" style="width: 100%; border-radius: 5px; border: 1px solid #e1e8ea;">`:""}\n                    </div>\n                    ${e>0?"":" \n                    <div>\n                        <img width=\"140px\" src='img/products/BHandH.png'>\n                    </div>"}\n                </div>\n                <div class="onboarding-nav">\n                    ${e>0?'\n                        <button onclick="prevStep()" style="padding: 10px 14px; background: #ecf0f1; border: none; border-radius: 5px; cursor: pointer;"><i class="fas fa-arrow-left"></i></button>\n                    ':'<button onclick="prevStep()" style="padding: 10px 14px; background: var(--neutral-gray); border: none; opacity: 0.46; border-radius: 5px; cursor: not-allowed;" disabled><i class="fas fa-arrow-left"></i></button>'}\n                    <div style="display: flex; align-items: center;">\n                        ${n.map(((t,n)=>`\n                            <div class="onboarding-dot ${n===e?"active":""}" onclick="goToStep(${n})"></div>\n                        `)).join("")}\n                    </div>\n                    <div style="display: flex; gap: 10px;">\n                        <button onclick="completeOnboarding()" style="padding: 10px 20px; background: #95a5a6; color: white; border: none; border-radius: 5px; cursor: pointer;">\n                            Skip Tutorial\n                        </button>\n                        <button onclick="${e===n.length-1?"completeOnboarding()":"nextStep()"}" style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">\n                            ${e===n.length-1?"Get Started":"Next"}\n                        </button>\n                    </div>\n                </div>\n            `,document.querySelectorAll(".highlight-element").forEach((e=>e.remove())),n[e].highlight){const t=document.querySelector(n[e].highlight);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout((()=>{const e=t.getBoundingClientRect(),n=document.createElement("div");n.className="highlight-element",n.style.cssText=`\n                        position: fixed;\n                        top: ${e.top-6}px;\n                        left: ${e.left-6}px;\n                        width: ${e.width+8}px;\n                        height: ${e.height+8}px;\n                        border: 2px solid #3498db;\n                        border-radius: 4px;\n                        pointer-events: none;\n                        z-index: 10000;\n                        animation: pulse .8s 2;\n                    `,document.body.appendChild(n)}),500))}}window.nextStep=function(){a<n.length-1&&(a++,o(a))},window.prevStep=function(){a>0&&(a--,o(a))},window.goToStep=function(e){a=e,o(a)},window.completeOnboarding=function(){localStorage.setItem("onboardingComplete","true"),e.remove(),document.querySelectorAll(".highlight-element").forEach((e=>e.remove()))};const r="This is a paragraph, click to edit it directly.",s="Hover over any component to reveal customization options. Use the ⋮ handle on the left to drag components into a new order or to another screen. The red 'x' on the right deletes the component, and the button at the bottom duplicates them. Each element has unique features to explore!";window.selectTemplate=e=>{const t=document.querySelector(".canvas-content");t.innerHTML="","template1"===e?[{component:this.components.adjustableSpace(),type:"adjustableSpace"},{component:this.components.image(),type:"image"},{component:this.components.avatar(),type:"avatar"},{component:this.components.chipGroup(),type:"chipGroup"},{component:this.components.heading(),type:"heading"},{component:this.components.paragraph(null,r),type:"paragraph"},{component:this.components.paragraph(null,s),type:"paragraph"}].forEach((({component:e,type:n})=>{t.appendChild(this.wrapComponentInContainer(e,n))})):"template2"===e?[{component:this.components.hero(),type:"hero"},{component:this.components.heading(),type:"heading"},{component:this.components.paragraph(null,r),type:"paragraph"},{component:this.components.paragraph(null,s),type:"paragraph"},{component:this.components.icon(),type:"icon"},{component:this.components.accordion(),type:"accordion"},{component:this.components.adjustableSpace(),type:"adjustableSpace"},{component:this.components.footer(),type:"footer"}].forEach((({component:e,type:n})=>{t.appendChild(this.wrapComponentInContainer(e,n))})):"template3"===e&&[{component:this.components.heading(),type:"heading"},{component:this.components.paragraph(null,r),type:"paragraph"},{component:this.components.label(),type:"label"},{component:this.components.input(),type:"input"},{component:this.components.label(),type:"label"},{component:this.components.textarea(),type:"textarea"},{component:this.components.label(),type:"label"},{component:this.components.dropdown(),type:"dropdown"},{component:this.components.label(),type:"label"},{component:this.components.checkbox(),type:"checkbox"},{component:this.components.checkbox(),type:"checkbox"},{component:this.components.checkbox(),type:"checkbox"},{component:this.components.adjustableSpace(),type:"adjustableSpace"},{component:this.components.button(),type:"button"}].forEach((({component:e,type:n})=>{t.appendChild(this.wrapComponentInContainer(e,n))})),localStorage.setItem("onboardingComplete","true"),document.querySelector(".onboarding-overlay").remove();const n=document.querySelector(".sidebar");n&&n.scrollTo({top:0,behavior:"smooth"})},e.appendChild(t),document.body.appendChild(e),setTimeout((()=>{e.classList.add("visible"),o(a)}),100)}components={hero:e=>{let t;return e?(t=e.cloneNode(!0),t):(t=document.createElement("div"),t.className="fw",t.innerHTML=setupVariants("hero")[0],t)},sidebar:e=>{const t=(e="bolt-lightning",t="New Item")=>{const n=document.createElement("div");n.className="sidebar-nav-item";const a=document.createElement("i");a.className=`fas fa-${e} icon-container`,a.style.cssText="\n                width: 20px;\n                text-align: center;\n                color: var(--color-primary);\n            ";const o=document.createElement("span");o.textContent=t,o.setAttribute("contenteditable","true"),o.style.flex="1";const r=document.createElement("button");return r.className="nav-item-delete",r.innerHTML="×",n.addEventListener("mouseenter",(()=>{n.style.outline="2px solid var(--neutral-gray)",r.style.display="block",setTimeout((()=>r.style.opacity="1"),0)})),n.addEventListener("mouseleave",(()=>{n.style.outline="none",r.style.opacity="0"})),r.addEventListener("click",(e=>{e.stopPropagation(),n.classList.add("delete-animation"),setTimeout((()=>n.remove()),200)})),a.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),showIconPicker(a)})),n.appendChild(a),n.appendChild(o),n.appendChild(r),n};let n;if(e)return n=e.cloneNode(!0),n;n=document.createElement("div"),n.className="sidebar-container";const a=document.createElement("div");a.className="sidebar-panel";const o=document.createElement("button");o.className="sidebar-toggle",o.innerHTML='<i class="fas fa-chevron-left"></i>';const r=document.createElement("div");r.className="sidebar-header";const s=document.createElement("div");s.className="card-image ui-sidebar-avatar",s.innerHTML='<i class="fas fa-image" style="color: var(--placeholder-color);"></i>';const l=document.createElement("h3");l.textContent="Sidebar Title",l.style.cssText="\n            margin: 0;\n            color: var(--basic-txt-color);\n        ",l.setAttribute("contenteditable","true"),r.appendChild(s),r.appendChild(l);const c=document.createElement("div");c.className="sidebar-nav";[{icon:"home",text:"Home"},{icon:"user",text:"Profile"},{icon:"cog",text:"Settings"},{icon:"envelope",text:"Messages"}].forEach((e=>{const n=document.createElement("div");n.className="icon-container",n.appendChild(t(e.icon,e.text)),c.appendChild(n)}));const i=document.createElement("div");i.className="sidebar-add-btn",i.innerHTML='<i class="fas fa-plus"></i> Add Item',n.addEventListener("mouseenter",(()=>{i.style.display="flex"})),n.addEventListener("mouseleave",(()=>{i.style.display="none"})),i.addEventListener("click",(()=>{c.appendChild(t())}));const d=document.createElement("div");d.className="sidebar-footer";const p=document.createElement("div");p.className="card-image ui-sidebar-user",p.innerHTML='<i class="fas fa-user" style="color: var(--placeholder-color);"></i>';const u=document.createElement("div");u.style.flex="1";const m=document.createElement("div");m.textContent="Display Name",m.style.fontWeight="500",m.style.color="var(--basic-txt-color)",m.setAttribute("contenteditable","true");const h=document.createElement("div");h.textContent="Role",h.style.cssText="font-size: 12px; color: #666;",h.setAttribute("contenteditable","true"),u.appendChild(m),u.appendChild(h);const y=document.createElement("div");y.className="icon-container";const v=document.createElement("i");v.className="fas fa-ellipsis-v",v.style.cssText="\n            color: var(--color-primary);\n            cursor: pointer;\n            padding: 8px;\n        ",y.appendChild(v),d.appendChild(p),d.appendChild(u),d.appendChild(y),a.appendChild(o),a.appendChild(r),a.appendChild(c),a.appendChild(i),a.appendChild(d);let b=!1;return o.addEventListener("click",(()=>{b=!b,b?(a.style.transform="translateX(-182px)",o.style.transform="translateY(-50%) rotate(180deg)",n.style.width="8px"):(a.style.transform="translateX(0)",o.style.transform="translateY(-50%) rotate(0deg)",n.style.width="240px")})),n.appendChild(a),this.setupImageUpload(n),n},button(e){let t;return e?t=e.cloneNode(!0):(t=document.createElement("div"),t.style.cssText="width: 100%; display: flex; justify-content: space-between; gap: 14px;",t.innerHTML=setupVariants("button")[0],t.classList.add("componentButton")),t.querySelectorAll(".button").forEach((e=>{e.setAttribute("contentEditable","true"),e.addEventListener("keypress",(e=>{"Enter"===e.key&&e.preventDefault()})),e.addEventListener("paste",(e=>{e.preventDefault();const t=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)}))})),t},blankCard:e=>{let t;return e?(t=e.cloneNode(!0),this.setupBlankCard(t)):(t=document.createElement("div"),t.className="blank-card-container",t.style.cssText="width: 100%; position: relative;",t.innerHTML=setupVariants("blankCard")[0],t.classList.add("blankCard")),this.setupBlankCard(t),t},input(e){let t;if(e){t=e.cloneNode(!0);const n=t.querySelector('[contenteditable="true"]');return n&&(n.addEventListener("input",(function(){""===this.textContent.trim()?this.classList.add("empty"):this.classList.remove("empty")})),n.addEventListener("keypress",(e=>{"Enter"===e.key&&e.preventDefault()})),n.addEventListener("paste",(e=>{e.preventDefault();const t=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)}))),t}t=document.createElement("div"),t.style.cssText="width: 100%;",t.innerHTML=setupVariants("input")[0];const n=t.querySelector('[contenteditable="true"]');if(n&&n.addEventListener("input",(function(){""===this.textContent.trim()?this.classList.add("empty"):this.classList.remove("empty")})),!document.querySelector("style[data-input-placeholder]")){const e=document.createElement("style");e.setAttribute("data-input-placeholder","true"),e.textContent="\n            [contenteditable=true].empty:before {\n            content: attr(data-placeholder);\n            color: #999;\n            cursor: text;\n            padding-left: 4px;\n            }\n        ",document.head.appendChild(e)}return t.classList.add("empty"),t.addEventListener("keypress",(e=>{"Enter"===e.key&&e.preventDefault()})),t.addEventListener("paste",(e=>{e.preventDefault();const t=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)})),t},searchBar(e){let t;if(e&&(t=e.cloneNode(!0)),t=document.createElement("div"),t.style.cssText="width: 100%;",t.innerHTML=setupVariants("searchBar")[0],!document.querySelector("style[data-search-placeholder]")){const e=document.createElement("style");e.setAttribute("data-search-placeholder","true"),e.textContent="\n                [contenteditable=true].empty:before {\n                    content: attr(data-placeholder);\n                    color: #999;\n                    cursor: text;\n                    padding-left: 4px;\n                }\n            ",document.head.appendChild(e)}const n=t.querySelector('[contenteditable="true"]');return n&&(n.classList.add("empty"),n.addEventListener("input",(function(){""===this.textContent.trim()?this.classList.add("empty"):this.classList.remove("empty")})),n.addEventListener("keypress",(e=>{"Enter"===e.key&&e.preventDefault()})),n.addEventListener("paste",(e=>{e.preventDefault();const t=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)}))),t},textarea(e){let t;if(e){t=e.cloneNode(!0);t.querySelector('[contenteditable="true"]'),t.querySelector(".resize-handle");return t}t=document.createElement("div"),t.style.cssText="width: 100%; position: relative;";const n=document.createElement("div");if(n.innerHTML=setupVariants("textarea")[0],!document.querySelector("style[data-textarea-placeholder]")){const e=document.createElement("style");e.setAttribute("data-textarea-placeholder","true"),e.textContent="\n            [contenteditable=true].empty:before {\n            content: attr(data-placeholder);\n            color: #999;\n            cursor: text;\n            }\n        ",document.head.appendChild(e)}return n.querySelector('[contenteditable="true"]').addEventListener("input",(function(){""===this.textContent.trim()?this.classList.add("empty"):this.classList.remove("empty")})),n.addEventListener("paste",(e=>{e.preventDefault();const t=(e.originalEvent||e).clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)})),t.appendChild(n),t},checkbox:e=>{let t,n,a,o;return e?(t=e.cloneNode(!0),n=t.querySelector(".checkbox-square-icon"),a=n.querySelector(".checkbox-check-icon"),o=t.querySelector("span"),this.setupCheckboxes(t),t):(t=document.createElement("div"),t.className="custom-checkbox-wrapper",n=document.createElement("div"),n.className="fa-regular fa-square checkbox-square-icon",a=document.createElement("i"),a.className="fa-solid fa-square-check checkbox-check-icon",a.style.color="var(--color-primary)",n.appendChild(a),o=document.createElement("span"),o.textContent="click to edit",o.style.cssText="font-size: 16px; color: var(--basic-txt-color)",t.appendChild(n),t.appendChild(o),this.setupCheckboxes(t),t)},radio:e=>{let t,n,a,o,r;return e?(t=e.cloneNode(!0),this.setupRadios(t),t):(t=document.createElement("div"),t.className="radio-wrapper",n=document.createElement("label"),n.className="radio-label",a=document.createElement("div"),a.className="radio-outer-circle",a.classList.add("custom-radio"),o=document.createElement("span"),o.className="radio-dot",o.style.cssText="\n            background-color: var(--color-primary);\n        ",a.appendChild(o),r=document.createElement("span"),r.textContent="click to edit",r.style.cssText="color: var(--basic-txt-color);",t.appendChild(n),n.appendChild(a),t.appendChild(r),this.setupRadios(t),t)},dropdown:e=>{let t;if(e)t=e.cloneNode(!0);else{t=document.createElement("div"),t.className="custom-dropdown-container";const e=document.createElement("div");e.className="dropdown-header";const n=document.createElement("div");n.className="selected-text",n.textContent="Dropdown";const a=document.createElement("i");a.className="fas fa-chevron-down";const o=document.createElement("div");o.className="options-container";const r=document.createElement("div");r.className="add-option-wrapper";const s=document.createElement("button");s.className="add-button",s.innerHTML='<i class="fas fa-plus"></i> Add Option',r.appendChild(s),["Option 1","Option 2"].forEach((e=>{o.appendChild((e=>{const t=document.createElement("div");t.className="option-wrapper";const n=document.createElement("div");n.className="option",n.setAttribute("contenteditable","true"),n.textContent=e;const a=document.createElement("button");return a.className="delete-button",a.innerHTML='<i class="fas fa-times"></i>',t.appendChild(n),t.appendChild(a),t})(e))})),e.appendChild(n),e.appendChild(a),t.appendChild(e),t.appendChild(o),o.appendChild(r)}return this.setupDropdown(t),t},icon(e){let t;if(e)t=e.cloneNode(!0);else{t=document.createElement("div"),t.classList="iconContainerClass align-content";const e=document.createElement("i");e.className="fa-solid fa-bolt-lightning icon-container",e.style.cssText="\n                color: var(--color-accent);\n            ",t.appendChild(e)}const n=t.querySelector("i")||t.firstChild,a=createAlignmentControls(t);t.iconAlignment=a;let o=t.querySelector("input.iconControls");if(o=document.createElement("input"),o.classList.add("iconControls"),o.type="number",o.min="12",o.max="96",o.value="24",t.appendChild(o),o.addEventListener("input",(e=>{n.style.fontSize=`${e.target.value}px`})),n){let e=getComputedStyle(n).fontSize||n.style.fontSize;const t=parseInt(e,10)||24;o.value=t,o.addEventListener("input",(e=>{n.style.fontSize=`${e.target.value}px`}))}else console.error("iconElement not found or not in the DOM");return n.addEventListener("click",(e=>{e.preventDefault(),showIconPicker(n)})),t},card(e){let t;return e?t=e.cloneNode(!0):(t=document.createElement("div"),t.innerHTML=setupVariants("card")[0],t.classList.add("componentCard")),t.querySelectorAll("h3, p").forEach((e=>{e.setAttribute("contentEditable","true")})),t},card2(e){let t;return e?t=e.cloneNode(!0):(t=document.createElement("div"),t.innerHTML=setupVariants("card2")[0],t.classList.add("componentCard")),t.querySelectorAll("h3, p").forEach((e=>{e.setAttribute("contentEditable","true")})),t},listItem:e=>{let t;return e?t=e.cloneNode(!0):(t=document.createElement("div"),t.style.cssText="width: 100%;",t.innerHTML=setupVariants("listItem")[0]),t},adjustableSpace:e=>{let t;if(e){t=e.cloneNode(!0);const n=t.querySelector(".space-range"),a=t.querySelector(".height-display");n&&a&&(n.addEventListener("input",(()=>{const e=n.value;t.style.height=`${e}px`,a.value=e})),a.addEventListener("change",(()=>{const e=a.value;t.style.height=`${e}px`,n.value=e})))}else{t=document.createElement("div"),t.classList.add("blankSpace"),t.style.height="28px";const e=document.createElement("input");e.type="number",e.classList.add("height-display"),e.value="28",e.min="1",e.style.fontSize="16px",e.style.zIndex="99999";const n=document.createElement("input");n.className="space-range",n.type="range",n.min="4",n.max="300",n.value="28",n.style.width="100%";const a=document.createElement("div");a.classList="empty-placeholder fa-solid fa-arrows-alt-v",n.addEventListener("input",(()=>{const a=n.value;t.style.height=`${a}px`,e.value=a})),e.addEventListener("change",(()=>{const a=e.value;t.style.height=`${a}px`,n.value=a})),t.appendChild(e),t.appendChild(n),t.appendChild(a)}return t},image(e){let t;return e?t=e.cloneNode(!0):(t=document.createElement("div"),t.classList.add("non-editable"),t.className="ui-image-con",t.innerHTML=setupVariants("image")[0]),t},imgGallery(e){let t;if(e)return t=e.cloneNode(!0),t;t=document.createElement("div"),t.className="image-gallery-con";const n=document.createElement("div");n.className="ig-left-column-con";const a=document.createElement("div");a.className="ig-right-column-con";const o=()=>{const e=document.createElement("div");e.className="ig-image-wrapper";const t=document.createElement("div");t.classList="card-image resizeable ig-img-box",t.innerHTML='\n                <i style="color: var(--placeholder-color)" class="fa-solid fa-image non-editable"></i>\n                <span style="color: var(--basic-txt-color)" class="imgMsg non-editable">Click to add image</span>\n                ',resizer.makeResizable(t);const n=document.createElement("button");return n.innerHTML="×",n.className="gallery-image-delete-btn",n.classList.add("non-editable"),n.onclick=()=>e.remove(),n.addEventListener("click",(e=>e.stopPropagation())),e.appendChild(n),n.addEventListener("mouseenter",(()=>e.style.outline="1px solid var(--error-danger-delete)")),n.addEventListener("mouseleave",(()=>e.style.outline="none")),e.appendChild(t),e};n.appendChild(o()),a.appendChild(o()),n.appendChild(o()),a.appendChild(o()),t.appendChild(n),t.appendChild(a),new Sortable(n,{animation:150,group:"imgGal"}),new Sortable(a,{animation:150,group:"imgGal"});const r=(()=>{const e=document.createElement("button");return e.classList="fa fa-plus ig-add-btn",e})();return t.appendChild(r),setupImageGallery(t),t},navbar:()=>{const e=document.createElement("div");e.className="navContain",e.style.cssText="position: relative;";const t=document.createElement("div");t.style.cssText="background-color: rgba(0,0,0,0.12); width: 100%; height: 54px; position: absolute; top:0; left: 0; z-index: 1";const n=document.createElement("div");n.className="navbar top-navbar";const a=document.createElement("button");a.innerHTML='<i class="fas fa-circle-left"></i>',a.className="nav-control prev-nav";const o=document.createElement("button");o.innerHTML='<i class="fas fa-circle-right"></i>',o.className="nav-control next-nav",e.addEventListener("mouseenter",(()=>{a.style.opacity="1",o.style.opacity="1"})),e.addEventListener("mouseleave",(()=>{a.style.opacity="0",o.style.opacity="0"}));let r=0;const s={content:setupVariants("navbar"),cached:[]};s.cached=[...s.content],n.innerHTML=s.cached[r];const l=document.createElement("div");l.style.cssText="position: absolute; bottom: -24px; left: 50%; transform: translateX(-50%); display: flex; gap: 8px;",l.appendChild(a),l.appendChild(o),this.setupImageUpload(n),this.setupIconPicker(n);const c=()=>{this.setupImageUpload(n),this.setupIconPicker(n),n.querySelectorAll("span:not(.non-editable), a").forEach((e=>{e.contentEditable=!0}))};c();return new MutationObserver((()=>{s.cached[r]=n.innerHTML})).observe(n,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),a.addEventListener("click",(()=>{r=(r-1+s.cached.length)%s.cached.length,n.innerHTML=s.cached[r],n.style.backgroundColor=2===r?"var(--color-primary)":"var(--color-background)",c()})),o.addEventListener("click",(()=>{r=(r+1)%s.cached.length,n.innerHTML=s.cached[r],n.style.backgroundColor=2===r?"var(--color-primary)":"var(--color-background)",c()})),e.appendChild(n),e.appendChild(t),e.appendChild(a),e.appendChild(o),e},alert:e=>{let t;return e?(t=e.cloneNode(!0),t.querySelectorAll("span").forEach((e=>{e.setAttribute("contentEditable","true")}))):(t=document.createElement("div"),t.style.cssText="width: 100%",t.innerHTML=setupVariants("alert")[0],t.querySelectorAll("span").forEach((e=>{e.setAttribute("contentEditable","true")}))),t},modal:()=>{const e=document.createElement("div");e.className="modal-wrapper",e.style.cssText="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.6); display: flex; justify-content: center; align-items: center; z-index: 991; height: 100%; flex-direction: column;";const t=document.createElement("div");t.style.cssText="width: calc(100% - 46px); max-width: 400px; display: flex; justify-content: flex-end; padding: 8px;";const n=document.createElement("div");n.innerHTML="&times;",n.style.cssText="font-size: 30px; color: white; cursor: pointer;",t.appendChild(n);const a=document.createElement("div");return a.className="ui-modal",a.innerHTML='\n                <h2 contenteditable="true" style="margin-top: 0; color: var(--basic-txt-color);">Modal Title</h2>\n                <p contenteditable="true" style="color: #7f8c8d;">This is the modal content. You can add any information here.</p>\n                <div style="text-align: right;">\n                    <div contenteditable="true" class="modal-ok-btn">OK</div>\n                </div>\n            ',e.appendChild(t),e.appendChild(a),this.setupModal(e),e},toggleSwitch:()=>{const e=document.createElement("div");e.className="toggle-switch-container";const t=document.createElement("span");t.textContent="Off",t.style.cssText="margin-right: 10px; cursor: pointer;",t.setAttribute("contenteditable","true");const n=document.createElement("div");n.className="toggle-switch";const a=document.createElement("div");a.className="toggle-slider round",a.style.cssText="background-color: var(--color-primary);";const o=document.createElement("div");o.className="toggle-thumb round";const r=document.createElement("span");r.textContent="On",r.style.cssText="margin-left: 10px; cursor: pointer;",r.setAttribute("contenteditable","true");let s=!0;const l=()=>{s=!s,s?(a.style.backgroundColor="var(--color-primary)",o.style.left="30px"):(a.style.backgroundColor="var(--neutral-gray)",o.style.left="4px")};return a.appendChild(o),n.appendChild(a),n.addEventListener("click",l),t.addEventListener("click",(()=>{s=!0,l()})),r.addEventListener("click",(()=>{s=!1,l()})),e.appendChild(t),e.appendChild(n),e.appendChild(r),e},progressBar:e=>{let t;return e?t=e.cloneNode(!0):(t=document.createElement("div"),t.className="fw",t.style.textAlign="center",t.innerHTML=setupVariants("progressBar")[0]),this.setupProgressBar(t),t},avatar(e){const t=document.createElement("div");t.className="avatar-container align-content",t.innerHTML=e?e.innerHTML:setupVariants("avatar")[0];const n=createAlignmentControls(t);return t.alignmentControls=n,t},tabs:e=>{let t;if(e)return t=e.cloneNode(!0),this.setupTabs(t),t;{t=document.createElement("div"),t.className="tabs-container";const e=document.createElement("div");e.className="tabs-wrapper",e.style.cssText="display: flex; width: 100%;";const n=document.createElement("div");n.className="tabs-controls";const a=document.createElement("button");a.textContent="+",a.className="tabs-add-btn";const o=document.createElement("button");o.textContent="-",o.className="tabs-remove-btn";for(let t=1;t<=2;t++){const n=document.createElement("div");n.textContent=`Tab ${t}`,n.setAttribute("contentEditable","true"),n.className="ui-tab",n.style.cssText=`\n                    background-color: ${1===t?"var(--color-primary)":"var(--neutral-gray)"};\n                    color: ${1===t?"white":"var(--basic-txt-color)"};\n                `,1===t&&n.classList.add("selected"),e.appendChild(n)}n.appendChild(o),n.appendChild(a),t.appendChild(e),t.appendChild(n)}return this.setupTabs(t),t},accordion:e=>{if(e){const t=e.cloneNode(!0),n=t.querySelector(".accordion-content");return requestAnimationFrame((()=>{this.setupAccordionContent(n)})),t}const t=document.createElement("div");t.className="accordion-container",t.style.cssText="border: .12rem solid var(--color-primary)",t.innerHTML='\n        <button class="accordion-header" style="background-color: var(--color-primary);">\n            <span contenteditable="true" style="color: var(--basic-txt-color);">Section Title</span>\n            <i class="fas fa-chevron-down" style="transition: transform 0.3s ease;"></i>\n        </button>\n        <div class="accordion-content">\n            <div class="placeholder" style="padding: 18px 0;">\n                <div>\n                    <span class="non-editable" style="margin: 0 24px; color: #666; text-align: center;">drag & drop components here.</span>\n                </div>\n            </div>\n        </div>\n    ';const n=t.querySelector(".accordion-content");return this.setupAccordionContent(n),t},slider:e=>{if(e){const t=e.cloneNode(!0),n=t.querySelector("input"),a=t.querySelector(".range-value");return n.addEventListener("input",(()=>{a.textContent=n.value})),t}const t=document.createElement("div");t.className="range-slider-container";const n=document.createElement("input");n.type="range",n.min="0",n.max="100",n.value="50",n.className="custom-range-slider",n.style.flex="1";const a=document.createElement("span");return a.className="range-value",a.textContent="50",t.appendChild(n),t.appendChild(a),n.addEventListener("input",(()=>{a.textContent=n.value})),t},datePicker:e=>{let t,n,a,o;if(e)return t=e.cloneNode(!0),n=t.querySelector("span"),a=t.querySelector("i"),o=t.querySelector(".date-picker-calendar-con"),this.setupDatePicker(t,n,a,o),t;t=document.createElement("div"),t.className="date-picker-wrapper",n=document.createElement("span"),n.textContent="DD/MM/YYYY",n.style.cssText="opacity: 0.7;",n.setAttribute("contenteditable","true"),n.setAttribute("spellcheck","false"),a=document.createElement("i"),a.className="fas fa-calendar-alt date-picker-icon",a.style.color="var(--color-primary)",o=document.createElement("div"),o.className="date-picker-calendar-con";const r=document.createElement("div");r.className="date-picker-month-text",r.textContent="January",r.setAttribute("contenteditable","true");const s=document.createElement("div");s.className="date-picker-year-text",s.textContent="2025",s.setAttribute("contenteditable","true");const l=document.createElement("div");l.className="date-picker-days-grid";for(let e=1;e<=31;e++){const t=document.createElement("span");t.textContent=e,t.className="date-picker-day-cell",l.appendChild(t)}return o.append(r,s,l),t.append(n,a,o),this.setupDatePicker(t,n,a,o),t},fileUpload:e=>{let t,n,a,o;if(e)return t=e.cloneNode(!0),n=t.querySelector('input[type="file"]'),a=t.querySelector("label"),o=t.querySelector(".file-preview-container"),r(),t;function r(){const e=["image/jpeg","image/png","image/gif","image/webp"];function t(t){const n=document.createElement("div");n.className="file-upload-preview-card";const a=document.createElement("div");if(a.className="file-upload-preview-card-content",e.includes(t.type)){const e=document.createElement("img");e.className="file-upload-preview-img";const n=new FileReader;n.onload=t=>e.src=t.target.result,n.readAsDataURL(t),a.appendChild(e)}else{const e=document.createElement("i");e.className="fas fa-file",e.style.cssText="\n                        font-size: 40px;\n                        color: var(--color-primary);\n                    ",a.appendChild(e)}const o=document.createElement("div");o.textContent=t.name.length>15?t.name.substring(0,12)+"...":t.name,o.className="file-upload-preview-filename",a.appendChild(o);const r=document.createElement("div");r.textContent=(t.size/1048576).toFixed(2)+" MB",r.style.cssText="\n                    font-size: 9px;\n                    color: #666;\n                ",a.appendChild(r);const s=document.createElement("button");return s.innerHTML="×",s.className="file-upload-preview-delete-btn",s.onclick=()=>n.remove(),n.appendChild(a),n.appendChild(s),n.addEventListener("mouseenter",(()=>s.style.display="block")),n.addEventListener("mouseleave",(()=>s.style.display="none")),n}n.addEventListener("change",(()=>{o.innerHTML="",Array.from(n.files).forEach((e=>{o.appendChild(t(e))}))})),a.addEventListener("click",(()=>{n.click()})),["dragenter","dragover","dragleave","drop"].forEach((e=>{a.addEventListener(e,(e=>{e.preventDefault(),e.stopPropagation()}))})),a.addEventListener("dragenter",(()=>{a.style.backgroundColor="rgba(0, 0, 0, 0.02)",a.style.borderColor="var(--color-primary)",a.innerHTML='<i class="fas fa-cloud-upload-alt"><br><br></i>'})),a.addEventListener("dragleave",(()=>{a.style.backgroundColor="var(--input-bg-color)",a.style.borderColor="var(--neutral-gray)",a.innerHTML='<span><i class="fas fa-cloud-upload-alt"></i> Drop files here or click to upload</span>'})),a.addEventListener("drop",(e=>{a.style.backgroundColor="var(--input-bg-color)",a.style.borderColor="var(--neutral-gray)";const r=e.dataTransfer.files;n.files=r,o.innerHTML="",Array.from(r).forEach((e=>{o.appendChild(t(e))}))}))}return t=document.createElement("div"),t.className="file-upload-container",n=document.createElement("input"),n.type="file",n.class="file-upload-input",n.multiple=!0,a=document.createElement("label"),a.htmlFor="file-upload",a.className="file-upload-label",a.innerHTML='<span><i class="fas fa-cloud-upload-alt"></i> Drop files here or click to upload</span>',o=document.createElement("div"),o.className="file-preview-container",t.appendChild(n),t.appendChild(a),t.appendChild(o),r(),t},bottomNav:()=>{const e=document.createElement("nav");e.className="bottomNavContain max-items";const t=document.createElement("div");t.className="shadow-div";const n=document.createElement("div");n.className="bottomNav bottom-navbar",n.innerHTML='\n                <div class="nav-item-container">\n                    <button class="nav-delete-btn">×</button>\n                    <div class="bottom-nav-item">\n                        <i class="fas fa-home" ></i>\n                        <span class="usa" contenteditable="true">Home</span>\n                    </div>\n                </div>\n                <div class="nav-item-container">\n                    <button class="nav-delete-btn">×</button>\n                    <div class="bottom-nav-item">\n                        <i class="fas fa-search"></i>\n                        <span class="usa" contenteditable="true">Search</span>\n                    </div>\n                </div>\n                <div class="nav-item-container">\n                    <button class="nav-delete-btn">×</button>\n                    <div class="bottom-nav-item">\n                        <i class="fas fa-plus"></i>\n                        <span class="usa" contenteditable="true">Add</span>\n                    </div>\n                </div>\n                <div class="nav-item-container">\n                    <button class="nav-delete-btn">×</button>\n                    <div class="bottom-nav-item">\n                        <i class="fas fa-heart"></i>\n                        <span class="usa" contenteditable="true">Like</span>\n                    </div>\n                </div>\n                <div class="nav-item-container">\n                    <button class="nav-delete-btn">×</button>\n                    <div class="bottom-nav-item">\n                        <i class="fas fa-user"></i>\n                        <span class="usa" contenteditable="true">Profile</span>\n                    </div>\n                </div>\n                <button class="nav-add-btn"><i class="fas fa-plus"></i></button>\n            ',n.querySelectorAll(".nav-delete-btn").forEach((t=>{t.addEventListener("click",(function(){n.querySelectorAll(".nav-item-container").length>1&&(this.closest(".nav-item-container").remove(),o(e))}))}));const a=n.querySelector(".nav-add-btn");function o(e){e.querySelectorAll(".nav-item-container").length>=5?e.classList.add("max-items"):e.classList.remove("max-items")}return a.addEventListener("click",(()=>{if(n.querySelectorAll(".nav-item-container").length<5){const t=document.createElement("div");t.className="nav-item-container",t.innerHTML='\n                        <button class="nav-delete-btn">×</button>\n                        <div class="bottom-nav-item">\n                            <i class="fa-solid fa-bolt-lightning"></i>\n                            <span class="usa" contenteditable="true">New</span>\n                        </div>\n                    ',t.querySelector(".nav-delete-btn").addEventListener("click",(function(){n.querySelectorAll(".nav-item-container").length>1&&(this.closest(".nav-item-container").remove(),o(e))})),t.querySelector("i").addEventListener("click",(e=>{e.preventDefault(),showIconPicker(e.target)})),n.insertBefore(t,a),o(e)}})),n.querySelectorAll(".nav-item-container i").forEach((e=>{e.style.cursor="pointer",e.addEventListener("click",(t=>{t.preventDefault(),showIconPicker(e)}))})),e.appendChild(t),e.appendChild(n),e},heading(e,t="h1",n="Heading"){const a=["h1","h2","h3","h4","h5","h6"];let o=a.indexOf(t.toLowerCase());-1===o&&(o=0);const r=document.createElement("div");r.className="heading-wrapper";const s=document.createElement("div");s.className="heading-controls",s.style.display="none",s.style.opacity="0",s.style.transition="opacity 0.2s ease";const l=document.createElement("span");l.className="level-indicator",l.style.opacity="0",l.style.transition="opacity 0.2s ease";const c=document.createElement("button");c.className="heading-increment-btn",c.style.opacity="0",c.style.transition="opacity 0.2s ease";const i=document.createElement("i");let d;if(i.className="fas fa-angle-right",c.appendChild(i),e){const t=e.querySelector("h1, h2, h3, h4, h5, h6");if(t){const e=t.tagName.toLowerCase();o=a.indexOf(e),-1===o&&(o=0),d=document.createElement(e),d.textContent=t.textContent,d.style.cssText=t.style.cssText||"margin: 0;",t.style.textAlign&&(d.style.textAlign=t.style.textAlign),d.setAttribute("contentEditable","true"),t.classList.contains("usa")&&d.classList.add("usa")}else d=document.createElement(a[o]),d.textContent=n,d.className="usa",d.setAttribute("contentEditable","true"),d.style.cssText="margin: 0;"}else d=document.createElement(a[o]),d.textContent=n,d.className="usa",d.setAttribute("contentEditable","true"),d.style.cssText="margin: 0;";return c.addEventListener("click",(()=>{(e=>{o=(e+a.length)%a.length;const t=a[o],n=document.createElement(t);n.textContent=d.textContent,n.style.cssText=d.style.cssText,n.setAttribute("contentEditable","true"),d.classList.contains("usa")&&n.classList.add("usa"),l.textContent=t.toUpperCase(),d.replaceWith(n),d=n,r.dataset.headingLevel=t})(o+1)})),r.addEventListener("mouseenter",(()=>{s.style.display="flex",setTimeout((()=>{s.style.opacity="1",c.style.opacity="1",l.style.opacity="1"}),0)})),r.addEventListener("mouseleave",(()=>{s.style.opacity="0",c.style.opacity="0",l.style.opacity="0",setTimeout((()=>{s.style.display="none"}),200)})),l.textContent=a[o].toUpperCase(),r.dataset.headingLevel=a[o],s.appendChild(l),s.appendChild(c),r.appendChild(s),r.appendChild(d),r},paragraph(e,t="This is a paragraph. Click to edit."){const n=document.createElement("div");n.style.cssText="width: 100%;";const a=document.createElement("div");let o;return e?o=e.cloneNode(!0):(o=document.createElement("p"),o.textContent=t,o.className="paragraph-element",o.classList.add("usa"),o.setAttribute("contentEditable","true"),o.addEventListener("input",(()=>{n.dataset.paragraphText=o.textContent}))),a.appendChild(o),n.appendChild(a),n},blockquote(e){const t=document.createElement("div");t.className="component-wrapper",t.style.cssText="width: 100%;";const n=document.createElement("div");let a;return e?a=e.cloneNode(!0):(a=document.createElement("blockquote"),a.className="blockquote-element",a.classList.add("usa"),a.textContent="This is a block-quote. Click to edit.",a.style.cssText="border-left: 5px solid var(--color-primary);",a.setAttribute("contentEditable","true"),a.addEventListener("input",(()=>{t.dataset.blockquoteText=a.textContent}))),n.appendChild(a),t.appendChild(n),t},label(e){let t;return e?t=e.cloneNode(!0):(t=document.createElement("label"),t.className="field-label-element",t.textContent="Label Text",t.setAttribute("contentEditable","true")),t},video:e=>{let t;return e?(t=e.cloneNode(!0),this.setupVideoEmbed(t)):(t=document.createElement("div"),t.className="fw",t.innerHTML=setupVariants("video")[0],this.setupVideoEmbed(t)),t},graph:()=>{const e=document.createElement("div");e.className="bar-graph-wrapper",e.classList.add("resizeable");const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=[{label:"Jan",value:30},{label:"Feb",value:45},{label:"Mar",value:25},{label:"Apr",value:60},{label:"May",value:40}],a=document.createElement("div");a.className="bar-graph-container";const o=document.createElement("div");o.className="bar-graph-grid-lines";const r=document.createElement("div");function s(){r.innerHTML="";const t=Math.max(...n.map((e=>e.value)),1);o.innerHTML="";let a="var(--color-primary)";const l=e.querySelectorAll(".bar-graph-bar");if(l.length>0){const e=window.getComputedStyle(l[0]);e.backgroundColor.includes("rgb(")||(a=e.backgroundColor)}for(let e=0;e<=5;e++){const n=document.createElement("div");n.className="bar-graph-grid-line";const a=document.createElement("div");a.className="bar-graph-grid-line-label",a.textContent=Math.round(t*(1-e/5)),n.appendChild(a),o.appendChild(n)}n.forEach(((e,o)=>{const l=document.createElement("div");l.className="bar-graph-bar-wrapper";const c=document.createElement("div");c.className="bar-graph-bar";const i=e.value/t*100;c.style.cssText=`\n                    height: ${i}%;\n                    background: ${a};\n                `;const d=document.createElement("div");d.className="bar-graph-bar-value",d.textContent=e.value,d.style.cssText=`\n                    bottom: ${i}%;   \n                `;const p=document.createElement("div");p.className="bar-graph-month-label",p.textContent=e.label;let u=!1;c.addEventListener("mousedown",(()=>{u=!0,c.style.backgroundColor="var(--interface-color)"})),document.addEventListener("mousemove",(e=>{if(!u)return;const a=r.getBoundingClientRect(),s=Math.max(0,Math.min(a.height,a.bottom-e.clientY)),l=Math.round(s/a.height*t);l!==n[o].value&&(n[o].value=l,d.textContent=l,c.style.height=l/t*100+"%")})),document.addEventListener("mouseup",(()=>{u&&(u=!1,c.style.backgroundColor=a,s())})),l.appendChild(d),l.appendChild(c),l.appendChild(p),r.appendChild(l)}))}r.className="bar-graph-bars-container";const l=document.createElement("div");l.className="bar-graph-controls";const c=document.createElement("button");c.className="bar-graph-add-btn",c.innerHTML='<i class="fas fa-plus"></i>';const i=document.createElement("button");return i.className="bar-graph-add-btn",i.innerHTML='<i class="fas fa-minus"></i>',c.onclick=()=>{n.length<12&&(n.push({label:t[n.length],value:Math.floor(80*Math.random())+10}),s())},i.onclick=()=>{n.length>2&&(n.pop(),s())},e.addEventListener("mouseenter",(()=>l.style.opacity="1")),e.addEventListener("mouseleave",(()=>l.style.opacity="0")),l.appendChild(i),l.appendChild(c),e.appendChild(l),a.appendChild(o),a.appendChild(r),e.appendChild(a),s(),createGraphColorSwatch(e),e},pieGraph:()=>{const e=document.createElement("div");e.className="pie-graph-wrapper";const t=[{label:"Segment A",value:35,color:"#5D0BB5"},{label:"Segment B",value:15,color:"#027BD1"},{label:"Segment C",value:15,color:"#00CD67"},{label:"Segment D",value:35,color:"#F23A0C"}],n=["#5D0BB5","#027BD1","#00CD67","#F23A0C","#CE1590","#FF5722","#E0CE28","#84898B"],a=document.createElement("div");a.className="color-picker-modal-overlay";const o=document.createElement("div");o.className="color-picker-modal-content";const r=document.createElement("button");r.className="close-color-modal",r.innerHTML="×",r.onclick=()=>a.style.display="none";const s=document.createElement("div");s.id="segment-color-picker";const l=document.createElement("div");let c;function i(){if(a.style.display="flex",c){for(;c.colors.length>t.length;)c.removeColor(c.colors.length-1);for(;c.colors.length<t.length;)c.addColor(t[c.colors.length].color);t.forEach(((e,t)=>{c.colors[t].hexString=e.color}))}else c?c.colors=t.map((e=>e.color)):(c=new iro.ColorPicker("#segment-color-picker",{width:190,colors:t.map((e=>e.color)),handleRadius:7,borderWidth:1,activeHandleRadius:11,borderColor:"#fff",wheelAngle:90,sliderSize:22}),c.on(["mount","color:change"],(function(){l.innerHTML="",c.colors.forEach(((e,n)=>{if(n<t.length){const a=e.hexString,o=document.createElement("div");o.style.cssText="\n                                display: flex;\n                                align-items: center;\n                                gap: 10px;\n                                cursor: pointer;\n                            ",o.innerHTML=`\n                                <div style="\n                                    width: 20px;\n                                    height: 20px;\n                                    background: ${a};\n                                    border-radius: 4px;\n                                "></div>\n                                <span style="color: var(--basic-txt-color);">${t[n].label}</span>\n                                <span style="color: gray; font-size: smaller; margin-left: auto;">${a}</span>\n                            `,o.onclick=()=>c.setActiveColor(n),l.appendChild(o)}}))})),c.on("color:change",(function(e){e.index<t.length&&(t[e.index].color=e.hexString,u())})))}l.className="modal-color-list-con",o.appendChild(r),o.appendChild(s),o.appendChild(l),a.appendChild(o),document.body.appendChild(a);const d=document.createElement("div");d.className="pie-graph-container";const p=200;function u(){d.innerHTML="";const e=t.reduce(((e,t)=>e+t.value),0),a=document.createElement("div");a.style.cssText=`\n                flex: 0 0 ${p}px;\n                height: ${p}px;\n                position: relative;\n            `;const o="http://www.w3.org/2000/svg",r=document.createElementNS(o,"svg");r.setAttribute("width",p),r.setAttribute("height",p),r.setAttribute("viewBox","-100 -100 200 200");const s=document.createElementNS(o,"defs"),l=document.createElementNS(o,"filter");l.setAttribute("id","hover-shadow"),l.innerHTML='\n                <feDropShadow dx="0" dy="0" stdDeviation="3" flood-opacity="0.3"/>\n            ',s.appendChild(l),r.appendChild(s);let c=0;t.forEach(((t,a)=>{const s=t.value/e,l=360*s,i=c+l,d=(c-90)*Math.PI/180,p=(i-90)*Math.PI/180,m=100*Math.cos(d),h=100*Math.sin(d),y=100*Math.cos(p),v=100*Math.sin(p),b=document.createElementNS(o,"path"),g=`M 0 0 L ${m} ${h} A 100 100 0 ${l>180?1:0} 1 ${y} ${v} Z`;b.setAttribute("d",g),b.setAttribute("fill",t.color||n[a]),b.style.cursor="pointer",b.style.transition="filter 0.2s",b.addEventListener("mouseenter",(()=>{b.style.filter="url(#hover-shadow)",b.style.opacity="0.9"})),b.addEventListener("mouseleave",(()=>{b.style.filter="none",b.style.opacity="1"})),b.addEventListener("click",(()=>{const e=prompt(`Enter new value for ${t.label}:`,t.value);e&&!isNaN(e)&&(t.value=Number(e),u())})),r.appendChild(b);const f=(c+l/2-90)*Math.PI/180,C=70*Math.cos(f),E=70*Math.sin(f),x=document.createElementNS(o,"g");x.setAttribute("transform",`translate(${C} ${E})`);const S=document.createElementNS(o,"text");S.textContent=`${Math.round(100*s)}%`,S.setAttribute("text-anchor","middle"),S.setAttribute("fill","var(--basic-txt-color)"),x.appendChild(S),r.appendChild(x),c=i})),a.appendChild(r),d.appendChild(a);const m=document.createElement("div");m.className="pie-graph-legend",t.forEach(((e,t)=>{const a=document.createElement("div");a.className="pie-graph-legend-item";const o=document.createElement("div");o.className="pie-graph-legend-color-box",o.style.cssText=`\n                    background: ${e.color||n[t]};\n                `,o.addEventListener("click",i);const r=document.createElement("input");r.className="pie-graph-legend-label",r.value=e.label,r.addEventListener("change",(()=>{e.label=r.value,u()})),a.appendChild(o),a.appendChild(r),m.appendChild(a)})),d.appendChild(m)}const m=document.createElement("div");m.className="pie-graph-controls";const h=document.createElement("button");h.className="pie-graph-add-btn",h.innerHTML='<i class="fas fa-plus"></i>';const y=document.createElement("button");return y.className="pie-graph-add-btn",y.innerHTML='<i class="fas fa-minus"></i>',h.onclick=()=>{t.length<8&&(t.push({label:`Segment ${String.fromCharCode(65+t.length)}`,value:Math.floor(30*Math.random())+10,color:n[t.length]}),u(),c&&c.addColor(n[t.length-1]))},y.onclick=()=>{t.length>2&&(t.pop(),u(),c&&c.removeColor(c.colors.length-1))},e.addEventListener("mouseenter",(()=>m.style.opacity="1")),e.addEventListener("mouseleave",(()=>m.style.opacity="0")),m.appendChild(y),m.appendChild(h),e.appendChild(m),e.appendChild(d),u(),e},pagination:e=>{let t;return e?t=e.cloneNode(!0):(t=document.createElement("div"),t.className="pagination-container",t.innerHTML='\n            <div class="pagination-wrapper">\n                \x3c!-- Previous page --\x3e\n                <button class="page-btn prev-page icon-container">\n                    <i style="color: var(--basic-txt-color);" class="fas fa-angle-left"></i>\n                </button>\n                \n                \x3c!-- Page numbers --\x3e\n                <button class="page-btn" contenteditable="true">1</button>\n                <button class="page-btn" contenteditable="true">2</button>\n                <button class="page-btn" contenteditable="true">3</button>\n                <button class="page-btn" contenteditable="true">...</button>\n                <button class="page-btn" contenteditable="true">45</button>\n                \n                \x3c!-- Next page --\x3e\n                <button class="page-btn next-page icon-container">\n                    <i style="color: var(--basic-txt-color);" class="fas fa-angle-right"></i>\n                </button>\n            </div>\n        '),this.setupPagination(t),t},leftChat:()=>{const e=document.createElement("div");e.className="chat-container",e.style.cssText="flex-direction: row;";const t=document.createElement("div");t.innerHTML="AV",t.className="chat-avatar",t.style.cssText="background-color: var(--color-primary); ",t.setAttribute("contentEditable","true");const n=document.createElement("div");n.style.cssText="flex-grow: 1; max-width: 80%;";const a=document.createElement("div");a.classList="leftChat";const o=document.createElement("div");o.className="chat-content",o.innerHTML="Click to edit this message.",o.setAttribute("contentEditable","true");const r=document.createElement("div");r.className="chat-image-container",r.style.cssText="margin-top: 8px; cursor: pointer; display: none;",a.addEventListener("mouseenter",(()=>{r.style.display="block"})),a.addEventListener("mouseleave",(()=>{const e=r.querySelector("img");e&&"none"!==e.style.display||(r.style.display="none")}));const s=document.createElement("img");s.className="chat-image",s.style.cssText="display: none;",s.alt="Chat image";const l=document.createElement("div");l.className="chat-image-placeholder",l.style.cssText="color: #666; border: 0.12rem dashed #ccc;";const c=document.createElement("i");c.className="fas fa-image",c.style.marginRight="8px",l.appendChild(c),l.appendChild(document.createTextNode("Add Image"));const i=document.createElement("div");return i.textContent="1 minute ago",i.className="chat-timestamp",i.setAttribute("contentEditable","true"),r.addEventListener("click",(()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{s.src=e.target.result,s.style.display="block",l.style.display="none",r.style.display="block"},e.readAsDataURL(t)}},e.click()})),r.appendChild(s),r.appendChild(l),a.appendChild(o),a.appendChild(r),n.appendChild(a),n.appendChild(i),e.appendChild(t),e.appendChild(n),e},rightChat:()=>{const e=document.createElement("div");e.className="chat-container";const t=document.createElement("div");t.innerHTML="ME",t.className="chat-avatar",t.style.cssText="background-color: var(--color-primary);",t.setAttribute("contentEditable","true");const n=document.createElement("div");n.className="chat-content-wrapper";const a=document.createElement("div");a.classList="rightChat",a.style.cssText="background-color: var(--color-primary);";const o=document.createElement("div");o.className="chat-content",o.innerHTML="Click to edit this message.",o.setAttribute("contentEditable","true");const r=document.createElement("div");r.className="chat-image-container",r.style.cssText="margin-top: 8px; cursor: pointer; display: none;",a.addEventListener("mouseenter",(()=>{r.style.display="block"})),a.addEventListener("mouseleave",(()=>{const e=r.querySelector("img");e&&"none"!==e.style.display||(r.style.display="none")}));const s=document.createElement("img");s.className="chat-image",s.style.cssText="display: none;",s.alt="Chat image";const l=document.createElement("div");l.className="chat-image-placeholder";const c=document.createElement("i");c.className="fas fa-image",c.style.marginRight="8px",l.appendChild(c),l.appendChild(document.createTextNode("Add Image"));const i=document.createElement("div");return i.textContent="1 minute ago",i.className="chat-timestamp",i.setAttribute("contentEditable","true"),r.addEventListener("click",(()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{s.src=e.target.result,s.style.display="block",l.style.display="none",r.style.display="block"},e.readAsDataURL(t)}},e.click()})),r.appendChild(s),r.appendChild(l),a.appendChild(o),a.appendChild(r),n.appendChild(a),n.appendChild(i),e.appendChild(t),e.appendChild(n),e},chatInput:e=>{let t;return e?t=e.cloneNode(!0):(t=document.createElement("div"),t.style.cssText="width: 100%; padding: 4px 0;",t.innerHTML=setupVariants("chatInput")[0]),t},notificationBanner:e=>{let t,n,a,o,r,s,l,c;return e?(t=e.cloneNode(!0),n=t.querySelector("div:first-child"),a=n.querySelector("i"),o=t.querySelector("div:nth-child(2)"),r=o.querySelector("div:nth-child(1)"),s=o.querySelector("div:nth-child(2)"),l=o.querySelector(".notification-action-btn"),c=t.querySelector(".noti-visibility-toggle")):(t=document.createElement("div"),t.classList.add("notification-banner"),t.style.cssText="border-left: 4px solid var(--color-primary);",n=document.createElement("div"),n.classList.add("icon-container"),n.style.cssText="flex-shrink: 0;",a=document.createElement("i"),a.className="fas fa-bell",a.style.cssText="font-size: 20px; color: var(--color-accent);",n.appendChild(a),o=document.createElement("div"),o.style.cssText="flex-grow: 1; display: flex; flex-direction: column; gap: 4px;",r=document.createElement("div"),r.textContent="Click to edit this important notification message.",r.style.cssText="font-weight: 500; color: var(--basic-txt-color);",r.setAttribute("contentEditable","true"),s=document.createElement("div"),s.textContent="Additional details can go here.",s.style.cssText="font-size: 14px; color: #666;",s.setAttribute("contentEditable","true"),l=document.createElement("div"),l.className="notification-action-btn",l.textContent="Action",l.style.cssText="\n        background-color: var(--color-primary);\n      ",l.setAttribute("contentEditable","true"),l.dataset.alwaysVisible="true",c=document.createElement("div"),c.className="noti-visibility-toggle",c.innerHTML='<i class="fas fa-eye"></i>',o.appendChild(r),o.appendChild(s),o.appendChild(l),t.appendChild(n),t.appendChild(o),t.appendChild(c)),this.setupNotificationBanner(t),t},progressTracker:e=>{let t;if(e)return t=e.cloneNode(!0),this.setupProgressTracker(t),t;{t=document.createElement("div"),t.className="progress-tracker-container";const e=document.createElement("div");e.className="progress-tracker-controls";const n=document.createElement("button");n.className="pt-count-btn",n.innerHTML='<i class="fas fa-plus pt-add-step"></i>';const a=document.createElement("button");a.className="pt-count-btn",a.innerHTML='<i class="fas fa-minus pt-remove-step"></i>',a.style.opacity="0.5",e.appendChild(a),e.appendChild(n);const o=document.createElement("div");o.className="pt-initial-step-con",o.setAttribute("data-step","");const r=document.createElement("div");r.className="step-circle",r.style.cssText="background-color: var(--color-primary);",r.textContent="1",r.setAttribute("contentEditable","true");const s=document.createElement("div");s.className="pt-step-label",s.textContent="Step 1",s.setAttribute("contentEditable","true"),o.appendChild(r),o.appendChild(s);const l=document.createElement("div");l.className="steps-container",l.appendChild(o),t.appendChild(l),t.appendChild(e)}return this.setupProgressTracker(t),t},featureComparisonCard:e=>{let t;if(e)t=e.cloneNode(!0);else{t=document.createElement("div"),t.className="feature-comparison-card",t.style.cssText="border: .12rem solid var(--color-primary);";const e=document.createElement("div");e.contentEditable="true",e.className="comparison-card-header",e.textContent="Feature Comparison",e.style.cssText="background-color: var(--color-primary);";const n=document.createElement("div");n.className="comparison-card-content";const a=document.createElement("div");a.className="comparison-card-grid";const o=document.createElement("button");o.className="comparison-add-row-btn",o.innerHTML='<i class="fas fa-plus"></i> Add Feature';["Features","Basic","Pro"].forEach(((e,t)=>{const n=document.createElement("div");n.textContent=e,n.style.cssText=`\n          font-weight: bold; \n          color: #777; \n          padding: 8px 0; \n          ${t>0?"text-align: center;":""}\n        `,n.setAttribute("contenteditable","true"),a.appendChild(n)}));const r=e=>{const t=document.createElement("div");t.className="comparison-card-row";const n=document.createElement("button");n.innerHTML='<i class="fas fa-trash"></i>',n.className="delete-fc-row",n.style.display="none";const r=document.createElement("div");r.style.cssText="display: flex; align-items: center; gap: 8px; width: 100%;";const s=document.createElement("span");s.textContent=e,s.setAttribute("contenteditable","true"),r.appendChild(s),r.appendChild(n),t.appendChild(r);const l=document.createElement("div");l.innerHTML='<i class="fas fa-check" style="color: green;"></i>',l.style.cssText="text-align: center; cursor: pointer;";const c=document.createElement("div");c.innerHTML='<i class="fas fa-check" style="color: green;"></i>',c.style.cssText="text-align: center; cursor: pointer;",[l,c].forEach((e=>{e.onclick=()=>{const t=null!==e.querySelector(".fa-check");e.innerHTML=t?'<i class="fas fa-times" style="color: #999;"></i>':'<i class="fas fa-check" style="color: green;"></i>'}})),n.onclick=e=>{e.stopPropagation(),[t,l,c].forEach((e=>e.remove()));a.children.length/3-1<20&&(o.style.opacity="1",o.style.cursor="pointer")},t.addEventListener("mouseenter",(()=>{n.style.display="block"})),t.addEventListener("mouseleave",(()=>{n.style.display="none"})),a.appendChild(t),a.appendChild(l),a.appendChild(c)};r("Feature 1"),r("Feature 2"),r("Feature 3"),n.appendChild(a),t.appendChild(e),t.appendChild(n),t.appendChild(o)}return this.setupFeatureComparisonCard(t),t},columns:e=>{let t;if(e)t=e.cloneNode(!0);else{t=document.createElement("div"),t.className="columns-wrapper";const e=document.createElement("div");e.className="columns-controls";const n=document.createElement("div");n.className="columns-gap-control";const a=document.createElement("input");a.className="columns-gap-range",a.type="range",a.min="0",a.max="46",a.value="6";const o=document.createElement("span");o.className="columns-gap-value",o.textContent="6";const r=document.createElement("button");r.className="column-count-btn",r.innerHTML='<i class="fas fa-minus"></i>';const s=document.createElement("button");s.className="column-count-btn",s.innerHTML='<i class="fas fa-plus"></i>';const l=document.createElement("span");l.className="column-count-value",l.textContent="2",n.appendChild(a),n.appendChild(o),e.appendChild(r),e.appendChild(l),e.appendChild(s),e.appendChild(n),t.appendChild(e)}return this.setupColumns(t),t},chipGroup:e=>{let t;if(e)return t=e.cloneNode(!0),this.setupChipGroup(t),t;{t=document.createElement("div"),t.className="chip-group-wrapper";const e=document.createElement("div");e.className="chip-group-container";const n=document.createElement("button");n.className="add-chip-btn",n.innerHTML='<i class="fas fa-plus"></i>&nbsp; add pill',["Design","Development","Marketing"].forEach((t=>{const n=document.createElement("div");n.className="chip",n.setAttribute("data-selected","false");const a=document.createElement("span");a.textContent=t;const o=document.createElement("i");o.className="fas fa-times remove-chip",n.appendChild(a),n.appendChild(o),e.appendChild(n)})),t.appendChild(n),t.appendChild(e)}return this.setupChipGroup(t),createGroupColorSwatch(t),t},floatingActionButton:()=>{const e=document.createElement("div");e.classList.add("fab-container");const t=document.createElement("div");t.classList="fab-nav icon-container",t.style.cssText="\n      background-color: var(--color-primary);\n    ";const n=document.createElement("i");n.className="fas fa-plus fab-icon",t.appendChild(n),t.addEventListener("click",(e=>{e.preventDefault(),showIconPicker(n)})),e.addEventListener("mouseenter",(()=>{e.style.pointerEvents="auto"})),e.addEventListener("mouseleave",(()=>{e.style.pointerEvents="none"})),e.appendChild(t);const a=createAlignmentControls(e);return a.setAlignment("center"),a.hideArrows(),e},bulletedList:e=>{const t=document.createElement("div");if(t.className="bullet-list-container",e){const t=e.cloneNode(!0);return this.setupBulletedList(t),t}const n=(e="New item")=>{const t=document.createElement("div");t.className="bullet-list-item";const n=document.createElement("div");n.className="bullet-list-item-icon icon-container";const a=document.createElement("i");a.className="fas fa-circle  bullet-icon",n.appendChild(a),n.addEventListener("click",(e=>{e.preventDefault(),showIconPicker(a)}));const o=document.createElement("div");o.className="bullet-list-item-text",o.setAttribute("contenteditable","true"),o.textContent=e;const r=document.createElement("div");r.className="bullet-list-item-controls";const s=document.createElement("i");s.className="fas fa-indent bullet-list-indent-btn";const l=document.createElement("i");l.className="fas fa-outdent bullet-list-outdent-btn";const c=document.createElement("i");return c.className="fas fa-times bullet-list-delete-btn",r.appendChild(s),r.appendChild(l),r.appendChild(c),t.appendChild(n),t.appendChild(o),t.appendChild(r),t.addEventListener("mouseenter",(()=>{r.style.display="flex"})),t.addEventListener("mouseleave",(()=>{r.style.display="none"})),t},a=document.createElement("div");a.className="bullet-list-add-btn",a.setAttribute("spellcheck","false");const o=document.createElement("i");o.className="fas fa-plus add-bullet-icon";const r=document.createElement("span");return r.className="add-bullet-text",r.textContent="Add item",a.appendChild(o),a.appendChild(r),t.appendChild(n("First item"),a),t.appendChild(n("Second item"),a),t.appendChild(a),this.setupBulletedList(t),t},table:()=>{const e=document.createElement("div");e.className="data-table-scroll-wrapper";const t=document.createElement("div");t.className="data-table-button-container";const n=document.createElement("button");n.className="data-table-add-column-btn",n.innerHTML='<i class="fas fa-plus"></i><span>Column</span>';const a=document.createElement("button");a.className="data-table-add-row-btn",a.innerHTML='<i class="fas fa-plus"></i><span>Row</span>',t.appendChild(a),t.appendChild(n);const o=document.createElement("div");o.className="data-table-container";const r=document.createElement("div");r.className="data-table-header-bg",r.style.backgroundColor="var(--color-primary)";const s=document.createElement("table");s.className="data-table-main";const l=document.createElement("thead"),c=document.createElement("tr"),i=document.createElement("tbody");e.appendChild(o),o.appendChild(r),o.appendChild(s),s.appendChild(l),l.appendChild(c),s.appendChild(i),e.buttonContainer=t;const d=this;return setTimeout((function(){try{const n=e.closest(".component-container");if(!n)return void console.error("Component container not found");const a=n.querySelector(".component-content");if(!a)return void console.error("Component content not found");a.appendChild(t);if(!a.querySelector(".data-table-scroll-wrapper"))return void console.error("Table wrapper not found in new context");console.log("Content children:",Array.from(a.children).map((e=>e.className))),d.setupTable(a)}catch(e){console.error("Error in setupAfterWrap:",e)}}),100),e},hzDivider:e=>{let t,n,a;e?(t=e.cloneNode(!0),n=t.querySelector("div:nth-child(2)"),a=n.querySelector(".divider-line")):(t=document.createElement("div"),t.className="hzRule",n=document.createElement("div"),n.className="hzRule-container",a=document.createElement("div"),a.classList.add("divider-line"),a.style.cssText="\n            border-color: var(--color-transparent-blk);\n        ",n.appendChild(a));const o=document.createElement("div");o.classList.add("hzRuleControls");const r=[{icon:"minus",title:"Solid"},{icon:"ellipsis-h",title:"Dotted"},{icon:"grip-lines",title:"Double"}].map((({icon:e,title:t})=>{const n=document.createElement("i");return n.className=`fas fa-${e} hzRule-control-btn`,n.title=t,n})),s=document.createElement("input");s.className="hzRule-thickness-control",s.type="range",s.min="1",s.max="8",s.value="2",r[0].addEventListener("click",(()=>{const e=s.value;a.style.borderStyle="solid",a.style.borderWidth=`${e}px 0 0 0`,a.style.borderColor="var(--color-transparent-blk)",a.style.background="none",a.style.height="0",n.style.flexDirection="row"})),r[1].addEventListener("click",(()=>{const e=s.value;a.style.borderStyle="dotted",a.style.background="none",a.style.height="0",a.style.borderWidth=`${e}px 0 0 0`,a.style.borderColor="var(--color-transparent-blk)",n.style.flexDirection="row"})),r[2].addEventListener("click",(()=>{const e=s.value;a.style.borderStyle="double",a.style.background="none",a.style.height="0",a.style.borderWidth=`${e}px 0 0 0`,a.style.borderColor="var(--color-transparent-blk)",n.style.flexDirection="row"})),s.addEventListener("input",(e=>{a.style.borderWidth=`${e.target.value}px 0 0 0`}));const l=document.createElement("div");l.className="hzRule-controls-container";const c=document.createElement("div");return c.className="hzRule-btns-container",r.forEach((e=>c.appendChild(e))),l.appendChild(c),l.appendChild(s),o.appendChild(l),t.appendChild(o),t.appendChild(n),t},colorBlock:e=>{let t,n;return e?(t=e.cloneNode(!0),n=t.querySelector(".colorBlock-inner")):(t=document.createElement("div"),t.style.cssText="width: 100%; position: relative;",t.classList.add("colorBlock-container"),n=document.createElement("div"),n.classList.add("colorBlock-inner"),n.style.cssText="\n            background-color: var(--color-secondary);\n        "),this.initializeSortable(n),t.appendChild(n),resizer.makeResizable(n),t},musicPlayer:e=>{let t;if(e)t=e.cloneNode(!0);else{t=document.createElement("div"),t.classList.add("music-player-container");const e=document.createElement("div");e.className="resizeable",e.style.cssText="\n                display: flex;\n                align-items: center;\n                gap: 16px;\n                margin-bottom: 16px;\n            ";const n=document.createElement("div");n.classList="card-image",n.style.cssText="\n                width: 80px;\n                height: 80px;\n                background-color: var(--neutral-gray);\n                border-radius: 4px;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                flex-shrink: 0;\n            ",n.innerHTML='<i class="fas fa-music" style="font-size: 24px;"></i>';const a=document.createElement("div");a.style.cssText="\n                flex-grow: 1;\n            ";const o=document.createElement("div");o.textContent="Song Title",o.style.cssText="\n                font-size: 18px;\n                font-weight: bold;\n                margin-bottom: 4px;\n            ",o.setAttribute("contenteditable","true");const r=document.createElement("div");r.textContent="Artist Name",r.style.cssText="\n                font-size: 14px;\n                opacity: 0.8;\n            ",r.setAttribute("contenteditable","true"),a.appendChild(o),a.appendChild(r);const s=document.createElement("div");s.style.cssText="\n                margin-bottom: 16px;\n            ";const l=document.createElement("div");l.style.cssText="\n                width: 100%;\n                height: 4px;\n                background-color: var(--neutral-gray);\n                border-radius: 2px;\n                margin-bottom: 8px;\n                position: relative;\n            ";const c=document.createElement("div");c.style.cssText="\n                width: 45%;\n                height: 100%;\n                background-color: var(--color-accent);\n                border-radius: 2px;\n                position: relative;\n            ";const i=document.createElement("div");i.style.cssText="\n                width: 12px;\n                height: 12px;\n                background-color: var(--color-accent);\n                border-radius: 50%;\n                position: absolute;\n                right: -6px;\n                top: 50%;\n                transform: translateY(-50%);\n            ";const d=document.createElement("div");d.style.cssText="\n                display: flex;\n                justify-content: space-between;\n                font-size: 12px;\n            ";const p=document.createElement("div");p.setAttribute("contenteditable","true"),p.textContent="1:45";const u=document.createElement("div");u.setAttribute("contenteditable","true"),u.textContent="3:30";const m=document.createElement("div");m.className="player-controls icon-container",m.style.cssText="\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                gap: 24px;\n            ";const h=(e,t="16px")=>{const n=document.createElement("i");return n.className=`fas ${e}`,n.style.cssText=`\n                    font-size: ${t};\n                    cursor: pointer;\n                    opacity: 0.8;\n                    transition: opacity 0.2s;\n                `,n.addEventListener("mouseenter",(()=>n.style.opacity="1")),n.addEventListener("mouseleave",(()=>n.style.opacity="0.8")),n};c.appendChild(i),l.appendChild(c),d.appendChild(p),d.appendChild(u),s.appendChild(l),s.appendChild(d),m.appendChild(h("fa-backward-step")),m.appendChild(h("fa-play","24px")),m.appendChild(h("fa-forward-step")),e.appendChild(n),e.appendChild(a),t.appendChild(e),t.appendChild(s),t.appendChild(m)}return t},footer:()=>{const e=document.createElement("footer");return e.innerHTML='\n            <div style="width: 100%; height: 100%; background-color: var(--color-primary); z-index: 1; padding: 0 10px; transform: translatex(-10px); position: relative; margin-bottom: -100px;">\n            <div style="display: flex; justify-content: space-between; width: 100%; padding: 20px 0; z-index: 2; position: relative;">\n                <div style="text-align: left;">\n                    <div class="card-image" style="margin-bottom: 10px; background-color: var(--neutral-gray); width: 50px; height: 50px; display: flex; justify-content: center; align-items: center; cursor: pointer;">\n                    <i style="color: var(--placeholder-color);" class="fa-solid fa-image non-editable"></i>\n                    </div>\n                    <div>\n                    <h3 spellcheck="false" contenteditable style="margin: 0; color: var(--basic-txt-color); ">Brand</h3>\n                    </div>\n                </div>\n                <div style="display: flex; gap: 28px; font-size: 14px; padding: 2px 8px;">\n                    <ul style="list-style: none; padding: 0; margin: 0;">\n                        <li contenteditable style="margin-bottom: 8px;"><a href="#" style="color: var(--basic-txt-color);  text-decoration: none;">About Us</a></li>\n                        <li contenteditable style="margin-bottom: 8px;"><a href="#" style="color: var(--basic-txt-color);  text-decoration: none;">Contact</a></li>\n                        <li contenteditable style="margin-bottom: 8px;"><a href="#" style="color: var(--basic-txt-color);  text-decoration: none;">Careers</a></li>\n                    </ul>\n                    <ul style="list-style: none; padding: 0; margin: 0;">\n                        <li contenteditable style="margin-bottom: 8px;"><a href="#" style="color: var(--basic-txt-color);  text-decoration: none;">Support</a></li>\n                        <li contenteditable style="margin-bottom: 8px;"><a href="#" style="color: var(--basic-txt-color);  text-decoration: none;">Privacy Policy</a></li>\n                        <li contenteditable style="margin-bottom: 8px;"><a href="#" style="color: var(--basic-txt-color);  text-decoration: none;">Terms of Use</a></li>\n                    </ul>\n                </div>\n            </div>\n                <div style="display: flex; gap: 40px; justify-content: center; padding: 24px 0 88px 0; border-top: 1px solid var(--neutral-gray);">\n                    <div class="icon-container">\n                        <i class="fas fa-seedling""></i>\n                    </div>\n                    <div class="icon-container">\n                        <i class="fas fa-bolt-lightning"></i>\n                    </div>\n                    <div class="icon-container">\n                        <i class="fas fa-skull"></i>\n                    </div>\n                </div>\n            </div>\n            <br>\n        ',e.style.cssText="width: 100%; position: relative;",e}}}const editor=window.editor||new MobileUIEditor;class Resizer{constructor(){this.isResizing=!1,this.resizeTimeout=null,this.currentElement=null,this.startY=0,this.startHeight=0,this.initialRightEdge=0,this.resizeOverlay=this.createOverlay(),this.setupListeners()}createOverlay(){const e=document.createElement("div");return e.className="resize-overlay",document.body.appendChild(e),e}createHandle(e){const t=document.createElement("div");t.className="resize-handle";const n=document.createElement("div");return n.className="reszie-icon",t.appendChild(n),t.addEventListener("mousedown",(t=>this.startResize(t,e))),t.addEventListener("mouseenter",(()=>t.style.display="flex")),t}startResize(e,t){this.isResizing=!0,this.currentElement=t,this.startY=e.pageY,this.startHeight=parseInt(window.getComputedStyle(t).height),this.startWidth=parseInt(window.getComputedStyle(t).width);const n=t.getBoundingClientRect();this.initialRightEdge=n.right,this.resizeOverlay.style.display="block",e.preventDefault(),e.stopPropagation()}setupListeners(){document.addEventListener("mousemove",(e=>{if(!this.isResizing)return;const t=this.currentElement.dataset.aspectRatio;if(t){const n=Math.max(0,this.startHeight+(e.pageY-this.startY)),a=n*parseFloat(t);this.currentElement.style.height=`${n}px`,this.currentElement.style.width=`${a}px`}else{const t=Math.max(0,this.startHeight+(e.pageY-this.startY));this.currentElement.style.height=`${t}px`}})),document.addEventListener("mouseup",(()=>{this.isResizing&&(this.isResizing=!1,this.currentElement=null,this.resizeOverlay.style.display="none")}))}makeResizable(e,t=!0){const n=e.querySelector(".resize-handle");n&&n.remove();const a=this.createHandle(e);return e.appendChild(a),t&&(e.addEventListener("mouseenter",(()=>{this.isResizing||(a.style.display="flex")})),e.addEventListener("mouseleave",(()=>{this.isResizing||(a.style.display="none")}))),a}}const resizer=new Resizer;